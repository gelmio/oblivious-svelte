import{S as t,i as e,s as o,e as s,c as a,b as r,f as n,h as l,j as c,l as i,y as u,a as h,t as f,D as d,v as p,d as m,g as b,k as v,m as x,z as g,A as y,E as k,r as E,G as w,H as T,O as I,Q as A,n as C,I as L,R as j,K as P,T as $,q as D,C as B}from"./client.efd44744.js";import{r as N,g as V}from"./reader-hints.10c6b79e.js";function O(t,e,o,s,a=null){let r;const n=l=>{const c=l-r,i=c/s,u=[e[0]+(o[0]-e[0])*i,e[1]+(o[1]-e[1])*i];c<s?(t.scrollTo(u[0],u[1]),requestAnimationFrame(n)):(t.scrollTo(o[0],o[1]),a&&a())};requestAnimationFrame((t=>{r=t,n(t)}))}const{document:q,window:H}=A;function z(t){let e,o,d,p,x,g,y,k,E,w,T,I,A;return{c(){e=s("div"),o=s("p"),d=f("Congrats! You've made it to the end of Book 2!"),p=h(),x=s("p"),g=f("That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),y=h(),k=s("p"),E=f("While you wait, feel free to jump on the mailing list, or maybe even "),w=s("a"),T=f("buy me a coffee!"),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=r(e);o=a(s,"P",{});var l=r(o);d=b(l,"Congrats! You've made it to the end of Book 2!"),l.forEach(n),p=m(s),x=a(s,"P",{});var c=r(x);g=b(c,"That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),c.forEach(n),y=m(s),k=a(s,"P",{});var i=r(k);E=b(i,"While you wait, feel free to jump on the mailing list, or maybe even "),w=a(i,"A",{href:!0,rel:!0,class:!0});var u=r(w);T=b(u,"buy me a coffee!"),u.forEach(n),i.forEach(n),s.forEach(n),this.h()},h(){l(w,"href","https://transactions.sendowl.com/products/78458726/77A44CD1/add_to_cart"),l(w,"rel","nofollow"),l(w,"class","border-b border-oblivious-dark"),l(e,"class","text-center font-header mt-8")},m(t,s){c(t,e,s),v(e,o),v(o,d),v(e,p),v(e,x),v(x,g),v(e,y),v(e,k),v(k,E),v(k,w),v(w,T),I||(A=i(w,"click",Q),I=!0)},p:u,d(t){t&&n(e),I=!1,A()}}}function M(t){let e,o,u,d,p,g,y,k,E=t[4]?"Chapter":"Book",w=t[11][1]>10&&!(t[11][1]%5)&&W();return{c(){e=s("div"),o=s("a"),u=f("Next "),d=f(E),g=h(),w&&w.c(),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=r(e);o=a(s,"A",{rel:!0,href:!0,class:!0});var l=r(o);u=b(l,"Next "),d=b(l,E),l.forEach(n),g=m(s),w&&w.l(s),s.forEach(n),this.h()},h(){l(o,"rel","prefetch"),l(o,"href",p="read/"+t[11][0]+"/"+t[11][1]),l(o,"class","inline-block text-lg p-2 rounded-lg no-underline bg-oblivious mr-4"),l(e,"class","flex flex-col md:flex-row justify-end items-end mt-8")},m(t,s){c(t,e,s),v(e,o),v(o,u),v(o,d),v(e,g),w&&w.m(e,null),y||(k=i(o,"click",U),y=!0)},p(t,s){16&s[0]&&E!==(E=t[4]?"Chapter":"Book")&&x(d,E),2048&s[0]&&p!==(p="read/"+t[11][0]+"/"+t[11][1])&&l(o,"href",p),t[11][1]>10&&!(t[11][1]%5)?w||(w=W(),w.c(),w.m(e,null)):w&&(w.d(1),w=null)},d(t){t&&n(e),w&&w.d(),y=!1,k()}}}function W(t){let e,o,u,h,d,p;return{c(){e=s("span"),o=f("... or "),u=s("a"),h=f("buy me a coffee!"),this.h()},l(t){e=a(t,"SPAN",{class:!0});var s=r(e);o=b(s,"... or "),u=a(s,"A",{href:!0,rel:!0,class:!0});var l=r(u);h=b(l,"buy me a coffee!"),l.forEach(n),s.forEach(n),this.h()},h(){l(u,"href","https://transactions.sendowl.com/products/78458726/77A44CD1/add_to_cart"),l(u,"rel","nofollow"),l(u,"class","border-b border-oblivious-dark"),l(e,"class","m-2")},m(t,s){c(t,e,s),v(e,o),v(e,u),v(u,h),d||(p=i(u,"click",K),d=!0)},d(t){t&&n(e),d=!1,p()}}}function G(t){let e,o,h,f;return{c(){e=s("div"),this.h()},l(t){e=a(t,"DIV",{class:!0}),r(e).forEach(n),this.h()},h(){l(e,"class","fixed inset-0 flex justify-center items-center cursor-zoom-out bg-oblivious-opaque")},m(o,s){c(o,e,s),t[19](e),h||(f=i(e,"click",t[20]),h=!0)},p:u,i(t){o||C((()=>{o=L(e,D,{}),o.start()}))},o:u,d(o){o&&n(e),t[19](null),h=!1,f()}}}function S(t){let e,o,d,p,x,g,y,k,w,T,I,A,j,P,$,B,N;return{c(){e=s("div"),o=s("div"),d=s("p"),p=f("Looks like you've been here before..."),x=h(),g=s("p"),y=f("Want to jump to the last page you were reading?"),k=h(),w=s("div"),T=s("button"),I=f("Sure"),A=h(),j=s("button"),P=f("Nup"),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=r(e);o=a(s,"DIV",{class:!0});var l=r(o);d=a(l,"P",{class:!0});var c=r(d);p=b(c,"Looks like you've been here before..."),c.forEach(n),x=m(l),g=a(l,"P",{class:!0});var i=r(g);y=b(i,"Want to jump to the last page you were reading?"),i.forEach(n),k=m(l),w=a(l,"DIV",{});var u=r(w);T=a(u,"BUTTON",{class:!0});var h=r(T);I=b(h,"Sure"),h.forEach(n),A=m(u),j=a(u,"BUTTON",{class:!0});var f=r(j);P=b(f,"Nup"),f.forEach(n),u.forEach(n),l.forEach(n),s.forEach(n),this.h()},h(){l(d,"class","font-header text-xl md:text-2xl"),l(g,"class","font-sans text-base md:text-lg mb-4"),l(T,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious"),l(j,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-white border border-solid border-oblivious cursor-pointer"),l(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),l(e,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,a){c(s,e,a),v(e,o),v(o,d),v(d,p),v(o,x),v(o,g),v(g,y),v(o,k),v(o,w),v(w,T),v(T,I),v(w,A),v(w,j),v(j,P),B||(N=[i(T,"click",t[22]),i(j,"click",t[23])],B=!0)},p:u,i(t){$||C((()=>{$=L(e,D,{delay:1e3}),$.start()}))},o:u,d(t){t&&n(e),B=!1,E(N)}}}function Y(t){let e,o,d,p,x,g,y,k,E,w,T,I,A,j,P,$,N,V,O,q,H,z,M,W,G;return{c(){e=s("div"),o=s("div"),d=s("p"),p=f("Here's some tips:"),x=h(),g=s("p"),y=f("Tap the text to turn the pages."),k=h(),E=s("p"),w=f("Tap the images to zoom."),T=h(),I=s("p"),A=f("I'll help you out by keeping track of where you're up to."),j=h(),P=s("p"),$=f("I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),N=h(),V=s("div"),O=s("span"),q=f("Got it"),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=r(e);o=a(s,"DIV",{class:!0});var l=r(o);d=a(l,"P",{class:!0});var c=r(d);p=b(c,"Here's some tips:"),c.forEach(n),x=m(l),g=a(l,"P",{class:!0});var i=r(g);y=b(i,"Tap the text to turn the pages."),i.forEach(n),k=m(l),E=a(l,"P",{class:!0});var u=r(E);w=b(u,"Tap the images to zoom."),u.forEach(n),T=m(l),I=a(l,"P",{class:!0});var h=r(I);A=b(h,"I'll help you out by keeping track of where you're up to."),h.forEach(n),j=m(l),P=a(l,"P",{class:!0});var f=r(P);$=b(f,"I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),f.forEach(n),N=m(l),V=a(l,"DIV",{});var v=r(V);O=a(v,"SPAN",{class:!0});var C=r(O);q=b(C,"Got it"),C.forEach(n),v.forEach(n),l.forEach(n),s.forEach(n),this.h()},h(){l(d,"class","font-header text-xl md:text-2xl mb-4"),l(g,"class","font-sans text-base md:text-lg mb-1"),l(E,"class","font-sans text-base md:text-lg mb-1"),l(I,"class","font-sans text-base md:text-lg mb-1"),l(P,"class","font-sans text-base md:text-lg mb-1"),l(O,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious cursor-pointer"),l(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),l(e,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,a){c(s,e,a),v(e,o),v(o,d),v(d,p),v(o,x),v(o,g),v(g,y),v(o,k),v(o,E),v(E,w),v(o,T),v(o,I),v(I,A),v(o,j),v(o,P),v(P,$),v(o,N),v(o,V),v(V,O),v(O,q),M=!0,W||(G=i(O,"click",t[21]),W=!0)},p:u,i(t){M||(C((()=>{z&&z.end(1),H||(H=L(e,D,{delay:1e3})),H.start()})),M=!0)},o(t){H&&H.invalidate(),z=B(e,D,{}),M=!1},d(t){t&&n(e),t&&z&&z.end(),W=!1,G()}}}function _(t){let e,o,u,w,T,I,A,C,L,$,D,B,N,V,O,W,_,R,X,U,K,Q,J,Z,tt;function et(t,e){return t[11][0]<3?M:z}q.title=e="Oblivious | Book "+t[2]+", Chapter "+t[3]+" | An overlanding motorbike journey\n\t\tthrough West Africa";let ot=et(t),st=ot(t),at=t[9]&&G(t);const rt=[Y,S],nt=[];function lt(t,e){return t[12]?0:t[10]?1:-1}return~(U=lt(t))&&(K=nt[U]=rt[U](t)),{c(){o=s("meta"),u=h(),w=s("article"),T=s("h2"),I=f("Book "),A=f(t[2]),C=f(", Chapter "),L=f(t[3]),$=h(),D=s("div"),N=h(),st.c(),O=h(),W=s("div"),_=f("Oblivious | Luke Gelmi"),R=h(),at&&at.c(),X=h(),K&&K.c(),Q=d(),this.h()},l(e){const s=p('[data-svelte="svelte-jk3wt5"]',q.head);o=a(s,"META",{name:!0,content:!0}),s.forEach(n),u=m(e),w=a(e,"ARTICLE",{class:!0});var l=r(w);T=a(l,"H2",{class:!0});var c=r(T);I=b(c,"Book "),A=b(c,t[2]),C=b(c,", Chapter "),L=b(c,t[3]),c.forEach(n),$=m(l),D=a(l,"DIV",{class:!0,style:!0});var i=r(D);N=m(i),st.l(i),i.forEach(n),O=m(l),W=a(l,"DIV",{class:!0});var h=r(W);_=b(h,"Oblivious | Luke Gelmi"),h.forEach(n),l.forEach(n),R=m(e),at&&at.l(e),X=m(e),K&&K.l(e),Q=d(),this.h()},h(){l(o,"name","description"),l(o,"content",t[1]),l(T,"class","font-header"),B=new j(N),l(D,"class","reader relative overflow-hidden no-scrollbar py-12 svelte-1hqhvkr"),l(D,"style",V=t[6]&&t[7]?`height: ${t[7]}px; columns: auto ${t[6]}px; column-gap: ${F}px; column-rule: 1px solid #000;`:""),l(W,"class","text-xs text-center -mt-10"),l(w,"class","prose md:prose-xl text-justify mb-8 md:mb-12 pt-16")},m(e,s){v(q.head,o),c(e,u,s),c(e,w,s),v(w,T),v(T,I),v(T,A),v(T,C),v(T,L),v(w,$),v(w,D),B.m(t[0],D),v(D,N),st.m(D,null),t[18](D),v(w,O),v(w,W),v(W,_),c(e,R,s),at&&at.m(e,s),c(e,X,s),~U&&nt[U].m(e,s),c(e,Q,s),J=!0,Z||(tt=[i(H,"resize",t[17]),i(D,"click",t[15])],Z=!0)},p(t,s){(!J||12&s[0])&&e!==(e="Oblivious | Book "+t[2]+", Chapter "+t[3]+" | An overlanding motorbike journey\n\t\tthrough West Africa")&&(q.title=e),(!J||2&s[0])&&l(o,"content",t[1]),(!J||4&s[0])&&x(A,t[2]),(!J||8&s[0])&&x(L,t[3]),(!J||1&s[0])&&B.p(t[0]),ot===(ot=et(t))&&st?st.p(t,s):(st.d(1),st=ot(t),st&&(st.c(),st.m(D,null))),(!J||192&s[0]&&V!==(V=t[6]&&t[7]?`height: ${t[7]}px; columns: auto ${t[6]}px; column-gap: ${F}px; column-rule: 1px solid #000;`:""))&&l(D,"style",V),t[9]?at?(at.p(t,s),512&s[0]&&g(at,1)):(at=G(t),at.c(),g(at,1),at.m(X.parentNode,X)):at&&(at.d(1),at=null);let a=U;U=lt(t),U===a?~U&&nt[U].p(t,s):(K&&(P(),y(nt[a],1,1,(()=>{nt[a]=null})),k()),~U?(K=nt[U],K||(K=nt[U]=rt[U](t),K.c()),g(K,1),K.m(Q.parentNode,Q)):K=null)},i(t){J||(g(at),g(K),J=!0)},o(t){y(K),J=!1},d(e){n(o),e&&n(u),e&&n(w),st.d(),t[18](null),e&&n(R),at&&at.d(e),e&&n(X),~U&&nt[U].d(e),e&&n(Q),Z=!1,E(tt)}}}var R=function(t,e,o,s){return new(o||(o=Promise))((function(a,r){function n(t){try{c(s.next(t))}catch(t){r(t)}}function l(t){try{c(s.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(n,l)}c((s=s.apply(t,e||[])).next())}))};function X({params:t,query:e}){return R(this,void 0,void 0,(function*(){const[e,o]=t.slug.map((t=>+t)),s=yield this.fetch(`read/${e}/${o}.json`),{chapter:a,snippet:r,nextChapterExists:n,message:l}=yield s.json();if(200===s.status)return{content:a,snippet:r,book:e,chapter:o,nextChapterExists:n};this.error(s.status,l)}))}let F=50;const U=t=>t.stopPropagation(),K=t=>t.stopPropagation(),Q=t=>t.stopPropagation();function J(t,e,o){let s,a,r;w(t,N,(t=>o(31,a=t))),w(t,V,(t=>o(12,r=t)));let n,l,c,i,u,h,f,d,p,m,{content:b}=e,{snippet:v}=e,{book:x}=e,{chapter:g}=e,{nextChapterExists:y}=e,k=!1,E=!1;const{page:A}=T();function C(){n&&(c=[window.innerWidth,window.innerHeight],(!l||!u||!i||c[0]<i||c[1]<u||c[0]>i+100||c[1]>u+100)&&(o(7,u=Math.round(c[1])),l=n.getBoundingClientRect(),o(6,i=Math.round(l.width))))}w(t,A,(t=>o(30,s=t)));const L=(j=()=>{const t=n.scrollLeft;setTimeout((()=>{const e=n.scrollLeft%(i+F);if(t===n.scrollLeft&&e){const t=e/(i+F)<.5?-e:i+F-e;O(n,[n.scrollLeft,n.scrollTop],[n.scrollLeft+t,n.scrollLeft],300)}}),50)},P=1e3,function(){clearTimeout(D),D=setTimeout((function(){j()}),P)});var j,P,D;function B(){const t=m[a[2]-1];t instanceof HTMLElement&&O(n,[n.scrollLeft,n.scrollTop],[t.offsetLeft,n.scrollTop],300,L)}function q(){m&&m.length>0&&(p=new IntersectionObserver((t=>{if(!0===t[0].isIntersecting){const e=Array.from(m).indexOf(t[0].target);e>-1&&e>a[2]-1&&N.set([H[0],H[1],e+1])}}),{threshold:[0]}),Array.from(m).forEach((t=>p.observe(t))))}I((()=>{var t,e;m=document.querySelectorAll(".reader p"),H&&(e=H,(!(t=a)||!t[0]||!t[1])&&e||e[0]>t[0]||e[0]===t[0]&&e[1]>t[1])?(N.set([H[0],H[1],1]),q()):a[0]===H[0]&&a[1]===H[1]&&a[2]>1?(o(10,E=!0),q()):a[0]===H[0]&&a[1]===H[1]&&1===a[2]&&q(),C(),setTimeout((()=>{C(),h=(window.pageYOffset||document.documentElement.scrollTop)+l.top,O(window,[window.scrollX,window.scrollY],[window.scrollX,h],600)}),2e3)}));let H;return t.$$set=t=>{"content"in t&&o(0,b=t.content),"snippet"in t&&o(1,v=t.snippet),"book"in t&&o(2,x=t.book),"chapter"in t&&o(3,g=t.chapter),"nextChapterExists"in t&&o(4,y=t.nextChapterExists)},t.$$.update=()=>{1073741824&t.$$.dirty[0]&&(H=s.params.slug?s.params.slug.map((t=>+t)):null),28&t.$$.dirty[0]&&o(11,d=!y&&x<3?[x+1,1]:[x,g+1])},[b,v,x,g,y,n,i,u,f,k,E,d,r,A,C,({clientX:t,target:e})=>{if("IMG"===e.tagName)o(9,k=!0),setTimeout((()=>{o(8,f.innerHTML=e.outerHTML,f)}),1);else if(t&&l&&l.left&&i){const e=l.left+i/2,o=i+F;O(n,[n.scrollLeft,n.scrollTop],[n.scrollLeft+(t<=e?-1:1)*o,n.scrollTop],300,L)}},B,()=>C(),function(t){$[t?"unshift":"push"]((()=>{n=t,o(5,n)}))},function(t){$[t?"unshift":"push"]((()=>{f=t,o(8,f)}))},()=>o(9,k=!1),()=>{V.set(!1)},()=>{o(10,E=!1),B()},()=>{o(10,E=!1),N.set([N[0],N[1],1])}]}export default class extends t{constructor(t){super(),e(this,t,J,_,o,{content:0,snippet:1,book:2,chapter:3,nextChapterExists:4},[-1,-1])}}export{X as preload};
