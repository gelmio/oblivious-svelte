import{S as t,i as e,s as o,e as s,c as r,b as a,f as n,h as l,j as c,l as i,y as h,a as u,t as f,D as d,v as p,d as m,g as v,k as x,m as b,z as g,A as k,E as y,r as w,G as E,H as T,O as I,Q as A,n as C,I as L,R as j,K as P,T as $,q as D,C as B}from"./client.3dcb8917.js";import{r as N,g as V}from"./reader-hints.f8a66aec.js";function O(t,e,o,s,r=null){let a;const n=l=>{const c=l-a,i=c/s,h=[e[0]+(o[0]-e[0])*i,e[1]+(o[1]-e[1])*i];c<s?(t.scrollTo(h[0],h[1]),requestAnimationFrame(n)):(t.scrollTo(o[0],o[1]),r&&r())};requestAnimationFrame((t=>{a=t,n(t)}))}const{document:q,window:H}=A;function z(t){let e,o,d,p,b,g,k,y,w,E,T,I,A;return{c(){e=s("div"),o=s("p"),d=f("Congrats! You've made it to the end of Book 2!"),p=u(),b=s("p"),g=f("That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),k=u(),y=s("p"),w=f("While you wait, feel free to jump on the mailing list, or "),E=s("a"),T=f("flick me some money to keep the wheels rolling!"),this.h()},l(t){e=r(t,"DIV",{class:!0});var s=a(e);o=r(s,"P",{});var l=a(o);d=v(l,"Congrats! You've made it to the end of Book 2!"),l.forEach(n),p=m(s),b=r(s,"P",{});var c=a(b);g=v(c,"That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),c.forEach(n),k=m(s),y=r(s,"P",{});var i=a(y);w=v(i,"While you wait, feel free to jump on the mailing list, or "),E=r(i,"A",{href:!0,rel:!0,class:!0});var h=a(E);T=v(h,"flick me some money to keep the wheels rolling!"),h.forEach(n),i.forEach(n),s.forEach(n),this.h()},h(){l(E,"href","https://transactions.sendowl.com/products/78458726/77A44CD1/add_to_cart"),l(E,"rel","nofollow"),l(E,"class","border-b border-oblivious-dark"),l(e,"class","text-center font-header mt-8")},m(t,s){c(t,e,s),x(e,o),x(o,d),x(e,p),x(e,b),x(b,g),x(e,k),x(e,y),x(y,w),x(y,E),x(E,T),I||(A=i(E,"click",Q),I=!0)},p:h,d(t){t&&n(e),I=!1,A()}}}function M(t){let e,o,h,d,p,g,k,y,w=t[4]?"Chapter":"Book",E=t[11][1]>10&&!(t[11][1]%5)&&W();return{c(){e=s("div"),o=s("a"),h=f("Next "),d=f(w),g=u(),E&&E.c(),this.h()},l(t){e=r(t,"DIV",{class:!0});var s=a(e);o=r(s,"A",{rel:!0,href:!0,class:!0});var l=a(o);h=v(l,"Next "),d=v(l,w),l.forEach(n),g=m(s),E&&E.l(s),s.forEach(n),this.h()},h(){l(o,"rel","prefetch"),l(o,"href",p="read/"+t[11][0]+"/"+t[11][1]),l(o,"class","inline-block text-lg p-2 rounded-lg no-underline bg-oblivious mr-4"),l(e,"class","flex flex-col md:flex-row justify-end items-end mt-8")},m(t,s){c(t,e,s),x(e,o),x(o,h),x(o,d),x(e,g),E&&E.m(e,null),k||(y=i(o,"click",U),k=!0)},p(t,s){16&s[0]&&w!==(w=t[4]?"Chapter":"Book")&&b(d,w),2048&s[0]&&p!==(p="read/"+t[11][0]+"/"+t[11][1])&&l(o,"href",p),t[11][1]>10&&!(t[11][1]%5)?E||(E=W(),E.c(),E.m(e,null)):E&&(E.d(1),E=null)},d(t){t&&n(e),E&&E.d(),k=!1,y()}}}function W(t){let e,o,h,u,d,p;return{c(){e=s("span"),o=f("... or "),h=s("a"),u=f("flick me some money!"),this.h()},l(t){e=r(t,"SPAN",{class:!0});var s=a(e);o=v(s,"... or "),h=r(s,"A",{href:!0,rel:!0,class:!0});var l=a(h);u=v(l,"flick me some money!"),l.forEach(n),s.forEach(n),this.h()},h(){l(h,"href","https://transactions.sendowl.com/products/78458726/77A44CD1/add_to_cart"),l(h,"rel","nofollow"),l(h,"class","border-b border-oblivious-dark"),l(e,"class","m-2")},m(t,s){c(t,e,s),x(e,o),x(e,h),x(h,u),d||(p=i(h,"click",K),d=!0)},d(t){t&&n(e),d=!1,p()}}}function G(t){let e,o,u,f;return{c(){e=s("div"),this.h()},l(t){e=r(t,"DIV",{class:!0}),a(e).forEach(n),this.h()},h(){l(e,"class","fixed inset-0 flex justify-center items-center cursor-zoom-out bg-oblivious-opaque")},m(o,s){c(o,e,s),t[19](e),u||(f=i(e,"click",t[20]),u=!0)},p:h,i(t){o||C((()=>{o=L(e,D,{}),o.start()}))},o:h,d(o){o&&n(e),t[19](null),u=!1,f()}}}function S(t){let e,o,d,p,b,g,k,y,E,T,I,A,j,P,$,N,V,O,q;return{c(){e=s("div"),o=s("div"),d=s("p"),p=f("Looks like you've been here before..."),b=u(),g=s("p"),k=f("Want to jump to the last page you were reading?"),y=u(),E=s("div"),T=s("button"),I=f("Sure"),A=u(),j=s("button"),P=f("Nup"),this.h()},l(t){e=r(t,"DIV",{class:!0});var s=a(e);o=r(s,"DIV",{class:!0});var l=a(o);d=r(l,"P",{class:!0});var c=a(d);p=v(c,"Looks like you've been here before..."),c.forEach(n),b=m(l),g=r(l,"P",{class:!0});var i=a(g);k=v(i,"Want to jump to the last page you were reading?"),i.forEach(n),y=m(l),E=r(l,"DIV",{});var h=a(E);T=r(h,"BUTTON",{class:!0});var u=a(T);I=v(u,"Sure"),u.forEach(n),A=m(h),j=r(h,"BUTTON",{class:!0});var f=a(j);P=v(f,"Nup"),f.forEach(n),h.forEach(n),l.forEach(n),s.forEach(n),this.h()},h(){l(d,"class","font-header text-xl md:text-2xl"),l(g,"class","font-sans text-base md:text-lg mb-4"),l(T,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious"),l(j,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-white border border-solid border-oblivious cursor-pointer"),l(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),l(e,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,r){c(s,e,r),x(e,o),x(o,d),x(d,p),x(o,b),x(o,g),x(g,k),x(o,y),x(o,E),x(E,T),x(T,I),x(E,A),x(E,j),x(j,P),V=!0,O||(q=[i(T,"click",t[22]),i(j,"click",t[23])],O=!0)},p:h,i(t){V||(C((()=>{N&&N.end(1),$||($=L(e,D,{delay:1e3})),$.start()})),V=!0)},o(t){$&&$.invalidate(),N=B(e,D,{}),V=!1},d(t){t&&n(e),t&&N&&N.end(),O=!1,w(q)}}}function Y(t){let e,o,d,p,b,g,k,y,w,E,T,I,A,j,P,$,N,V,O,q,H,z,M,W,G;return{c(){e=s("div"),o=s("div"),d=s("p"),p=f("Here's some tips:"),b=u(),g=s("p"),k=f("Tap the text to turn the pages."),y=u(),w=s("p"),E=f("Tap the images to zoom."),T=u(),I=s("p"),A=f("I'll help you out by keeping track of where you're up to."),j=u(),P=s("p"),$=f("I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),N=u(),V=s("div"),O=s("span"),q=f("Got it"),this.h()},l(t){e=r(t,"DIV",{class:!0});var s=a(e);o=r(s,"DIV",{class:!0});var l=a(o);d=r(l,"P",{class:!0});var c=a(d);p=v(c,"Here's some tips:"),c.forEach(n),b=m(l),g=r(l,"P",{class:!0});var i=a(g);k=v(i,"Tap the text to turn the pages."),i.forEach(n),y=m(l),w=r(l,"P",{class:!0});var h=a(w);E=v(h,"Tap the images to zoom."),h.forEach(n),T=m(l),I=r(l,"P",{class:!0});var u=a(I);A=v(u,"I'll help you out by keeping track of where you're up to."),u.forEach(n),j=m(l),P=r(l,"P",{class:!0});var f=a(P);$=v(f,"I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),f.forEach(n),N=m(l),V=r(l,"DIV",{});var x=a(V);O=r(x,"SPAN",{class:!0});var C=a(O);q=v(C,"Got it"),C.forEach(n),x.forEach(n),l.forEach(n),s.forEach(n),this.h()},h(){l(d,"class","font-header text-xl md:text-2xl mb-4"),l(g,"class","font-sans text-base md:text-lg mb-1"),l(w,"class","font-sans text-base md:text-lg mb-1"),l(I,"class","font-sans text-base md:text-lg mb-1"),l(P,"class","font-sans text-base md:text-lg mb-1"),l(O,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious cursor-pointer"),l(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),l(e,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,r){c(s,e,r),x(e,o),x(o,d),x(d,p),x(o,b),x(o,g),x(g,k),x(o,y),x(o,w),x(w,E),x(o,T),x(o,I),x(I,A),x(o,j),x(o,P),x(P,$),x(o,N),x(o,V),x(V,O),x(O,q),M=!0,W||(G=i(O,"click",t[21]),W=!0)},p:h,i(t){M||(C((()=>{z&&z.end(1),H||(H=L(e,D,{delay:1e3})),H.start()})),M=!0)},o(t){H&&H.invalidate(),z=B(e,D,{}),M=!1},d(t){t&&n(e),t&&z&&z.end(),W=!1,G()}}}function _(t){let e,o,h,E,T,I,A,C,L,$,D,B,N,V,O,W,_,R,X,U,K,Q,J,Z,tt;function et(t,e){return t[11][0]<3?M:z}q.title=e="Oblivious | Book "+t[2]+", Chapter "+t[3]+" | An overlanding motorbike journey\n\t\tthrough West Africa";let ot=et(t),st=ot(t),rt=t[9]&&G(t);const at=[Y,S],nt=[];function lt(t,e){return t[12]?0:t[10]?1:-1}return~(U=lt(t))&&(K=nt[U]=at[U](t)),{c(){o=s("meta"),h=u(),E=s("article"),T=s("h2"),I=f("Book "),A=f(t[2]),C=f(", Chapter "),L=f(t[3]),$=u(),D=s("div"),N=u(),st.c(),O=u(),W=s("div"),_=f("Oblivious | Luke Gelmi"),R=u(),rt&&rt.c(),X=u(),K&&K.c(),Q=d(),this.h()},l(e){const s=p('[data-svelte="svelte-jk3wt5"]',q.head);o=r(s,"META",{name:!0,content:!0}),s.forEach(n),h=m(e),E=r(e,"ARTICLE",{class:!0});var l=a(E);T=r(l,"H2",{class:!0});var c=a(T);I=v(c,"Book "),A=v(c,t[2]),C=v(c,", Chapter "),L=v(c,t[3]),c.forEach(n),$=m(l),D=r(l,"DIV",{class:!0,style:!0});var i=a(D);N=m(i),st.l(i),i.forEach(n),O=m(l),W=r(l,"DIV",{class:!0});var u=a(W);_=v(u,"Oblivious | Luke Gelmi"),u.forEach(n),l.forEach(n),R=m(e),rt&&rt.l(e),X=m(e),K&&K.l(e),Q=d(),this.h()},h(){l(o,"name","description"),l(o,"content",t[1]),l(T,"class","font-header"),B=new j(N),l(D,"class","reader relative overflow-hidden no-scrollbar py-12 svelte-1hqhvkr"),l(D,"style",V=t[6]&&t[7]?`height: ${t[7]}px; columns: auto ${t[6]}px; column-gap: ${F}px; column-rule: 1px solid #000;`:""),l(W,"class","text-xs text-center -mt-10"),l(E,"class","prose md:prose-xl text-justify mb-8 md:mb-12 pt-16")},m(e,s){x(q.head,o),c(e,h,s),c(e,E,s),x(E,T),x(T,I),x(T,A),x(T,C),x(T,L),x(E,$),x(E,D),B.m(t[0],D),x(D,N),st.m(D,null),t[18](D),x(E,O),x(E,W),x(W,_),c(e,R,s),rt&&rt.m(e,s),c(e,X,s),~U&&nt[U].m(e,s),c(e,Q,s),J=!0,Z||(tt=[i(H,"resize",t[17]),i(D,"click",t[15])],Z=!0)},p(t,s){(!J||12&s[0])&&e!==(e="Oblivious | Book "+t[2]+", Chapter "+t[3]+" | An overlanding motorbike journey\n\t\tthrough West Africa")&&(q.title=e),(!J||2&s[0])&&l(o,"content",t[1]),(!J||4&s[0])&&b(A,t[2]),(!J||8&s[0])&&b(L,t[3]),(!J||1&s[0])&&B.p(t[0]),ot===(ot=et(t))&&st?st.p(t,s):(st.d(1),st=ot(t),st&&(st.c(),st.m(D,null))),(!J||192&s[0]&&V!==(V=t[6]&&t[7]?`height: ${t[7]}px; columns: auto ${t[6]}px; column-gap: ${F}px; column-rule: 1px solid #000;`:""))&&l(D,"style",V),t[9]?rt?(rt.p(t,s),512&s[0]&&g(rt,1)):(rt=G(t),rt.c(),g(rt,1),rt.m(X.parentNode,X)):rt&&(rt.d(1),rt=null);let r=U;U=lt(t),U===r?~U&&nt[U].p(t,s):(K&&(P(),k(nt[r],1,1,(()=>{nt[r]=null})),y()),~U?(K=nt[U],K||(K=nt[U]=at[U](t),K.c()),g(K,1),K.m(Q.parentNode,Q)):K=null)},i(t){J||(g(rt),g(K),J=!0)},o(t){k(K),J=!1},d(e){n(o),e&&n(h),e&&n(E),st.d(),t[18](null),e&&n(R),rt&&rt.d(e),e&&n(X),~U&&nt[U].d(e),e&&n(Q),Z=!1,w(tt)}}}var R=function(t,e,o,s){return new(o||(o=Promise))((function(r,a){function n(t){try{c(s.next(t))}catch(t){a(t)}}function l(t){try{c(s.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(n,l)}c((s=s.apply(t,e||[])).next())}))};function X({params:t,query:e}){return R(this,void 0,void 0,(function*(){const[e,o]=t.slug.map((t=>+t)),s=yield this.fetch(`read/${e}/${o}.json`),{chapter:r,snippet:a,nextChapterExists:n,message:l}=yield s.json();if(200===s.status)return{content:r,snippet:a,book:e,chapter:o,nextChapterExists:n};this.error(s.status,l)}))}let F=50;const U=t=>t.stopPropagation(),K=t=>t.stopPropagation(),Q=t=>t.stopPropagation();function J(t,e,o){let s,r,a;E(t,N,(t=>o(31,r=t))),E(t,V,(t=>o(12,a=t)));let n,l,c,i,h,u,f,d,p,m,{content:v}=e,{snippet:x}=e,{book:b}=e,{chapter:g}=e,{nextChapterExists:k}=e,y=!1,w=!1;const{page:A}=T();function C(){c=[window.innerWidth,window.innerHeight],(!l||!h||!i||c[0]<i||c[1]<h||c[0]>i+100||c[1]>h+100)&&(o(7,h=Math.round(c[1])),l=n.getBoundingClientRect(),o(6,i=Math.round(l.width)))}E(t,A,(t=>o(30,s=t)));const L=(j=()=>{const t=n.scrollLeft;setTimeout((()=>{const e=n.scrollLeft%(i+F);if(t===n.scrollLeft&&e){const t=e/(i+F)<.5?-e:i+F-e;O(n,[n.scrollLeft,n.scrollTop],[n.scrollLeft+t,n.scrollLeft],300)}}),50)},P=1e3,function(){clearTimeout(D),D=setTimeout((function(){j()}),P)});var j,P,D;function B(){const t=m[r[2]-1];t instanceof HTMLElement&&O(n,[n.scrollLeft,n.scrollTop],[t.offsetLeft,n.scrollTop],300,L)}function q(){m&&m.length>0&&(p=new IntersectionObserver((t=>{if(!0===t[0].isIntersecting){const e=Array.from(m).indexOf(t[0].target);e>-1&&e>r[2]-1&&N.set([H[0],H[1],e+1])}}),{threshold:[0]}),Array.from(m).forEach((t=>p.observe(t))))}I((()=>{var t,e;m=document.querySelectorAll(".reader p"),H&&(e=H,(!(t=r)||!t[0]||!t[1])&&e||e[0]>t[0]||e[0]===t[0]&&e[1]>t[1])?(N.set([H[0],H[1],1]),q()):r[0]===H[0]&&r[1]===H[1]&&r[2]>1?(o(10,w=!0),q()):r[0]===H[0]&&r[1]===H[1]&&1===r[2]&&q(),C(),setTimeout((()=>{C(),u=(window.pageYOffset||document.documentElement.scrollTop)+l.top,O(window,[window.scrollX,window.scrollY],[window.scrollX,u],600)}),2e3)}));let H;return t.$$set=t=>{"content"in t&&o(0,v=t.content),"snippet"in t&&o(1,x=t.snippet),"book"in t&&o(2,b=t.book),"chapter"in t&&o(3,g=t.chapter),"nextChapterExists"in t&&o(4,k=t.nextChapterExists)},t.$$.update=()=>{1073741824&t.$$.dirty[0]&&(H=s.params.slug?s.params.slug.map((t=>+t)):null),28&t.$$.dirty[0]&&o(11,d=!k&&b<3?[b+1,1]:[b,g+1])},[v,x,b,g,k,n,i,h,f,y,w,d,a,A,C,({clientX:t,target:e})=>{if("IMG"===e.tagName)o(9,y=!0),setTimeout((()=>{o(8,f.innerHTML=e.outerHTML,f)}),1);else if(t&&l&&l.left&&i){const e=l.left+i/2,o=i+F;O(n,[n.scrollLeft,n.scrollTop],[n.scrollLeft+(t<=e?-1:1)*o,n.scrollTop],300,L)}},B,()=>C(),function(t){$[t?"unshift":"push"]((()=>{n=t,o(5,n)}))},function(t){$[t?"unshift":"push"]((()=>{f=t,o(8,f)}))},()=>o(9,y=!1),()=>{V.set(!1)},()=>{o(10,w=!1),B()},()=>{o(10,w=!1),N.set([N[0],N[1],1])}]}export default class extends t{constructor(t){super(),e(this,t,J,_,o,{content:0,snippet:1,book:2,chapter:3,nextChapterExists:4},[-1,-1])}}export{X as preload};
