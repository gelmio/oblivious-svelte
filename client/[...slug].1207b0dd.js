import{S as e,i as t,s as o,e as s,c as a,b as r,f as n,h as l,j as c,l as i,y as u,a as h,t as f,D as d,v as p,d as m,g,k as v,m as b,A as x,E as y,z as k,r as E,G as w,H as $,Q as T,R as I,n as L,I as P,T as C,K as j,U as A,O as B,u as N,w as D,x as V,B as O,q,C as H}from"./client.25ac0661.js";import{r as S,g as z}from"./reader-hints.7c0eaa1b.js";function W(e,t,o,s,a=null){let r;const n=l=>{const c=l-r,i=c/s,u=[t[0]+(o[0]-t[0])*i,t[1]+(o[1]-t[1])*i];c<s?(e.scrollTo(u[0],u[1]),requestAnimationFrame(n)):(e.scrollTo(o[0],o[1]),a&&a())};requestAnimationFrame((e=>{r=e,n(e)}))}const{document:G,window:M}=I;function Y(e){let t,o,d,p,b,y,E,w,$,T,I,L,P,C;return I=new B({props:{text:"buy me a coffee"}}),{c(){t=s("div"),o=s("p"),d=f("Congrats! You've made it to the end of Book 2!"),p=h(),b=s("p"),y=f("That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),E=h(),w=s("p"),$=f("While you wait, feel free to jump on the mailing list, or maybe even "),T=s("span"),N(I.$$.fragment),this.h()},l(e){t=a(e,"DIV",{class:!0});var s=r(t);o=a(s,"P",{});var l=r(o);d=g(l,"Congrats! You've made it to the end of Book 2!"),l.forEach(n),p=m(s),b=a(s,"P",{});var c=r(b);y=g(c,"That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),c.forEach(n),E=m(s),w=a(s,"P",{});var i=r(w);$=g(i,"While you wait, feel free to jump on the mailing list, or maybe even "),T=a(i,"SPAN",{class:!0});var u=r(T);D(I.$$.fragment,u),u.forEach(n),i.forEach(n),s.forEach(n),this.h()},h(){l(T,"class","border-b border-oblivious-dark"),l(t,"class","text-center font-header mt-8")},m(e,s){c(e,t,s),v(t,o),v(o,d),v(t,p),v(t,b),v(b,y),v(t,E),v(t,w),v(w,$),v(w,T),V(I,T,null),L=!0,P||(C=i(T,"click",oe),P=!0)},p:u,i(e){L||(k(I.$$.fragment,e),L=!0)},o(e){x(I.$$.fragment,e),L=!1},d(e){e&&n(t),O(I),P=!1,C()}}}function R(e){let t,o,u,d,p,E,w,$,T,I=e[3]?"Chapter":"Book",L=e[10][1]>10&&!(e[10][1]%5)&&U();return{c(){t=s("div"),o=s("a"),u=f("Next "),d=f(I),E=h(),L&&L.c(),this.h()},l(e){t=a(e,"DIV",{class:!0});var s=r(t);o=a(s,"A",{rel:!0,href:!0,class:!0});var l=r(o);u=g(l,"Next "),d=g(l,I),l.forEach(n),E=m(s),L&&L.l(s),s.forEach(n),this.h()},h(){l(o,"rel","prefetch"),l(o,"href",p="read/"+e[10][0]+"/"+e[10][1]),l(o,"class","inline-block text-lg p-2 rounded-lg no-underline bg-oblivious mr-4"),l(t,"class","flex flex-col md:flex-row justify-end items-end mt-8")},m(e,s){c(e,t,s),v(t,o),v(o,u),v(o,d),v(t,E),L&&L.m(t,null),w=!0,$||(T=i(o,"click",ee),$=!0)},p(e,s){(!w||8&s[0])&&I!==(I=e[3]?"Chapter":"Book")&&b(d,I),(!w||1024&s[0]&&p!==(p="read/"+e[10][0]+"/"+e[10][1]))&&l(o,"href",p),e[10][1]>10&&!(e[10][1]%5)?L?1024&s[0]&&k(L,1):(L=U(),L.c(),k(L,1),L.m(t,null)):L&&(j(),x(L,1,1,(()=>{L=null})),y())},i(e){w||(k(L),w=!0)},o(e){x(L),w=!1},d(e){e&&n(t),L&&L.d(),$=!1,T()}}}function U(e){let t,o,u,h,d,p,m;return h=new B({props:{text:"buy me a coffee"}}),{c(){t=s("span"),o=f("... or "),u=s("span"),N(h.$$.fragment),this.h()},l(e){t=a(e,"SPAN",{class:!0});var s=r(t);o=g(s,"... or "),u=a(s,"SPAN",{class:!0});var l=r(u);D(h.$$.fragment,l),l.forEach(n),s.forEach(n),this.h()},h(){l(u,"class","border-b border-oblivious-dark"),l(t,"class","m-2")},m(e,s){c(e,t,s),v(t,o),v(t,u),V(h,u,null),d=!0,p||(m=i(u,"click",te),p=!0)},i(e){d||(k(h.$$.fragment,e),d=!0)},o(e){x(h.$$.fragment,e),d=!1},d(e){e&&n(t),O(h),p=!1,m()}}}function X(e){let t,o,h,f;return{c(){t=s("div"),this.h()},l(e){t=a(e,"DIV",{class:!0}),r(t).forEach(n),this.h()},h(){l(t,"class","fixed inset-0 flex justify-center items-center cursor-zoom-out bg-oblivious-opaque")},m(o,s){c(o,t,s),e[18](t),h||(f=i(t,"click",e[19]),h=!0)},p:u,i(e){o||L((()=>{o=P(t,q,{}),o.start()}))},o:u,d(o){o&&n(t),e[18](null),h=!1,f()}}}function F(e){let t,o,d,p,b,x,y,k,w,$,T,I,C,j,A,B,N;return{c(){t=s("div"),o=s("div"),d=s("p"),p=f("Looks like you've been here before..."),b=h(),x=s("p"),y=f("Want to jump to the last page you were reading?"),k=h(),w=s("div"),$=s("button"),T=f("Sure"),I=h(),C=s("button"),j=f("Nup"),this.h()},l(e){t=a(e,"DIV",{class:!0});var s=r(t);o=a(s,"DIV",{class:!0});var l=r(o);d=a(l,"P",{class:!0});var c=r(d);p=g(c,"Looks like you've been here before..."),c.forEach(n),b=m(l),x=a(l,"P",{class:!0});var i=r(x);y=g(i,"Want to jump to the last page you were reading?"),i.forEach(n),k=m(l),w=a(l,"DIV",{});var u=r(w);$=a(u,"BUTTON",{class:!0});var h=r($);T=g(h,"Sure"),h.forEach(n),I=m(u),C=a(u,"BUTTON",{class:!0});var f=r(C);j=g(f,"Nup"),f.forEach(n),u.forEach(n),l.forEach(n),s.forEach(n),this.h()},h(){l(d,"class","font-header text-xl md:text-2xl"),l(x,"class","font-sans text-base md:text-lg mb-4"),l($,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious"),l(C,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-white border border-solid border-oblivious cursor-pointer"),l(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),l(t,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,a){c(s,t,a),v(t,o),v(o,d),v(d,p),v(o,b),v(o,x),v(x,y),v(o,k),v(o,w),v(w,$),v($,T),v(w,I),v(w,C),v(C,j),B||(N=[i($,"click",e[21]),i(C,"click",e[22])],B=!0)},p:u,i(e){A||L((()=>{A=P(t,q,{delay:1e3}),A.start()}))},o:u,d(e){e&&n(t),B=!1,E(N)}}}function K(e){let t,o,d,p,b,x,y,k,E,w,$,T,I,C,j,A,B,N,D,V,O,S,z,W,G;return{c(){t=s("div"),o=s("div"),d=s("p"),p=f("Here's some tips:"),b=h(),x=s("p"),y=f("Tap the text to turn the pages."),k=h(),E=s("p"),w=f("Tap the images to zoom."),$=h(),T=s("p"),I=f("I'll help you out by keeping track of where you're up to."),C=h(),j=s("p"),A=f("I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),B=h(),N=s("div"),D=s("span"),V=f("Got it"),this.h()},l(e){t=a(e,"DIV",{class:!0});var s=r(t);o=a(s,"DIV",{class:!0});var l=r(o);d=a(l,"P",{class:!0});var c=r(d);p=g(c,"Here's some tips:"),c.forEach(n),b=m(l),x=a(l,"P",{class:!0});var i=r(x);y=g(i,"Tap the text to turn the pages."),i.forEach(n),k=m(l),E=a(l,"P",{class:!0});var u=r(E);w=g(u,"Tap the images to zoom."),u.forEach(n),$=m(l),T=a(l,"P",{class:!0});var h=r(T);I=g(h,"I'll help you out by keeping track of where you're up to."),h.forEach(n),C=m(l),j=a(l,"P",{class:!0});var f=r(j);A=g(f,"I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),f.forEach(n),B=m(l),N=a(l,"DIV",{});var v=r(N);D=a(v,"SPAN",{class:!0});var L=r(D);V=g(L,"Got it"),L.forEach(n),v.forEach(n),l.forEach(n),s.forEach(n),this.h()},h(){l(d,"class","font-header text-xl md:text-2xl mb-4"),l(x,"class","font-sans text-base md:text-lg mb-1"),l(E,"class","font-sans text-base md:text-lg mb-1"),l(T,"class","font-sans text-base md:text-lg mb-1"),l(j,"class","font-sans text-base md:text-lg mb-1"),l(D,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious cursor-pointer"),l(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),l(t,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,a){c(s,t,a),v(t,o),v(o,d),v(d,p),v(o,b),v(o,x),v(x,y),v(o,k),v(o,E),v(E,w),v(o,$),v(o,T),v(T,I),v(o,C),v(o,j),v(j,A),v(o,B),v(o,N),v(N,D),v(D,V),z=!0,W||(G=i(D,"click",e[20]),W=!0)},p:u,i(e){z||(L((()=>{S&&S.end(1),O||(O=P(t,q,{delay:1e3})),O.start()})),z=!0)},o(e){O&&O.invalidate(),S=H(t,q,{}),z=!1},d(e){e&&n(t),e&&S&&S.end(),W=!1,G()}}}function Q(e){let t,o,u,w,$,T,I,L,P,A,B,N,D,V,O,q,H,S,z,W,U,Q,J,Z,ee,te;G.title=t="Oblivious | Book "+e[1]+", Chapter "+e[2]+" | An overlanding motorbike journey through West Africa";const oe=[R,Y],se=[];function ae(e,t){return e[10][0]<3?0:1}D=ae(e),V=se[D]=oe[D](e);let re=e[8]&&X(e);const ne=[K,F],le=[];function ce(e,t){return e[11]?0:e[9]?1:-1}return~(U=ce(e))&&(Q=le[U]=ne[U](e)),{c(){o=h(),u=s("article"),w=s("h2"),$=f("Book "),T=f(e[1]),I=f(", Chapter "),L=f(e[2]),P=h(),A=s("div"),N=h(),V.c(),q=h(),H=s("div"),S=f("Oblivious | Luke Gelmi"),z=h(),re&&re.c(),W=h(),Q&&Q.c(),J=d(),this.h()},l(t){p('[data-svelte="svelte-1uu6ren"]',G.head).forEach(n),o=m(t),u=a(t,"ARTICLE",{class:!0});var s=r(u);w=a(s,"H2",{class:!0});var l=r(w);$=g(l,"Book "),T=g(l,e[1]),I=g(l,", Chapter "),L=g(l,e[2]),l.forEach(n),P=m(s),A=a(s,"DIV",{class:!0,style:!0});var c=r(A);N=m(c),V.l(c),c.forEach(n),q=m(s),H=a(s,"DIV",{class:!0});var i=r(H);S=g(i,"Oblivious | Luke Gelmi"),i.forEach(n),s.forEach(n),z=m(t),re&&re.l(t),W=m(t),Q&&Q.l(t),J=d(),this.h()},h(){l(w,"class","font-header"),B=new C(N),l(A,"class","reader relative overflow-hidden no-scrollbar py-12 svelte-1hqhvkr"),l(A,"style",O=e[5]&&e[6]?`height: ${e[6]}px; columns: auto ${e[5]}px; column-gap: ${_}px; column-rule: 1px solid #000;`:""),l(H,"class","text-xs text-center -mt-10"),l(u,"class","prose md:prose-xl text-justify mb-8 md:mb-12 pt-16")},m(t,s){c(t,o,s),c(t,u,s),v(u,w),v(w,$),v(w,T),v(w,I),v(w,L),v(u,P),v(u,A),B.m(e[0],A),v(A,N),se[D].m(A,null),e[17](A),v(u,q),v(u,H),v(H,S),c(t,z,s),re&&re.m(t,s),c(t,W,s),~U&&le[U].m(t,s),c(t,J,s),Z=!0,ee||(te=[i(M,"resize",e[16]),i(A,"click",e[14])],ee=!0)},p(e,o){(!Z||6&o[0])&&t!==(t="Oblivious | Book "+e[1]+", Chapter "+e[2]+" | An overlanding motorbike journey through West Africa")&&(G.title=t),(!Z||2&o[0])&&b(T,e[1]),(!Z||4&o[0])&&b(L,e[2]),(!Z||1&o[0])&&B.p(e[0]);let s=D;D=ae(e),D===s?se[D].p(e,o):(j(),x(se[s],1,1,(()=>{se[s]=null})),y(),V=se[D],V||(V=se[D]=oe[D](e),V.c()),k(V,1),V.m(A,null)),(!Z||96&o[0]&&O!==(O=e[5]&&e[6]?`height: ${e[6]}px; columns: auto ${e[5]}px; column-gap: ${_}px; column-rule: 1px solid #000;`:""))&&l(A,"style",O),e[8]?re?(re.p(e,o),256&o[0]&&k(re,1)):(re=X(e),re.c(),k(re,1),re.m(W.parentNode,W)):re&&(re.d(1),re=null);let a=U;U=ce(e),U===a?~U&&le[U].p(e,o):(Q&&(j(),x(le[a],1,1,(()=>{le[a]=null})),y()),~U?(Q=le[U],Q||(Q=le[U]=ne[U](e),Q.c()),k(Q,1),Q.m(J.parentNode,J)):Q=null)},i(e){Z||(k(V),k(re),k(Q),Z=!0)},o(e){x(V),x(Q),Z=!1},d(t){t&&n(o),t&&n(u),se[D].d(),e[17](null),t&&n(z),re&&re.d(t),t&&n(W),~U&&le[U].d(t),t&&n(J),ee=!1,E(te)}}}var J=function(e,t,o,s){return new(o||(o=Promise))((function(a,r){function n(e){try{c(s.next(e))}catch(e){r(e)}}function l(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(n,l)}c((s=s.apply(e,t||[])).next())}))};function Z({params:e,query:t}){return J(this,void 0,void 0,(function*(){const[t,o]=e.slug.map((e=>+e)),s=yield this.fetch(`read/${t}/${o}.json`),{chapter:a,nextChapterExists:r,message:n}=yield s.json();if(200===s.status)return{content:a,book:t,chapter:o,nextChapterExists:r};this.error(s.status,n)}))}let _=50;const ee=e=>e.stopPropagation(),te=e=>e.stopPropagation(),oe=e=>e.stopPropagation();function se(e,t,o){let s,a,r;w(e,S,(e=>o(30,a=e))),w(e,z,(e=>o(11,r=e)));let n,l,c,i,u,h,f,d,p,m,{content:g}=t,{book:v}=t,{chapter:b}=t,{nextChapterExists:x}=t,y=!1,k=!1;const{page:E}=$();function I(){n&&(c=[window.innerWidth,window.innerHeight],(!l||!u||!i||c[0]<i||c[1]<u||c[0]>i+100||c[1]>u+100)&&(o(6,u=Math.round(c[1])),l=n.getBoundingClientRect(),o(5,i=Math.round(l.width))))}w(e,E,(e=>o(29,s=e)));const L=(P=()=>{const e=n.scrollLeft;setTimeout((()=>{const t=n.scrollLeft%(i+_);if(e===n.scrollLeft&&t){const e=t/(i+_)<.5?-t:i+_-t;W(n,[n.scrollLeft,n.scrollTop],[n.scrollLeft+e,n.scrollLeft],300)}}),50)},C=1e3,function(){clearTimeout(j),j=setTimeout((function(){P()}),C)});var P,C,j;function B(){const e=m[a[2]-1];e instanceof HTMLElement&&W(n,[n.scrollLeft,n.scrollTop],[e.offsetLeft,n.scrollTop],300,L)}function N(){m&&m.length>0&&(p=new IntersectionObserver((e=>{if(!0===e[0].isIntersecting){const t=Array.from(m).indexOf(e[0].target);t>-1&&t>a[2]-1&&S.set([D[0],D[1],t+1])}}),{threshold:[0]}),Array.from(m).forEach((e=>p.observe(e))))}T((()=>{var e,t;m=document.querySelectorAll(".reader p"),D&&(t=D,(!(e=a)||!e[0]||!e[1])&&t||t[0]>e[0]||t[0]===e[0]&&t[1]>e[1])?(S.set([D[0],D[1],1]),N()):a[0]===D[0]&&a[1]===D[1]&&a[2]>1?(o(9,k=!0),N()):a[0]===D[0]&&a[1]===D[1]&&1===a[2]&&N(),I(),setTimeout((()=>{I(),h=(window.pageYOffset||document.documentElement.scrollTop)+l.top,W(window,[window.scrollX,window.scrollY],[window.scrollX,h],600)}),2e3)}));let D;return e.$$set=e=>{"content"in e&&o(0,g=e.content),"book"in e&&o(1,v=e.book),"chapter"in e&&o(2,b=e.chapter),"nextChapterExists"in e&&o(3,x=e.nextChapterExists)},e.$$.update=()=>{536870912&e.$$.dirty[0]&&(D=s.params.slug?s.params.slug.map((e=>+e)):null),14&e.$$.dirty[0]&&o(10,d=!x&&v<3?[v+1,1]:[v,b+1])},[g,v,b,x,n,i,u,f,y,k,d,r,E,I,({clientX:e,target:t})=>{if("IMG"===t.tagName)o(8,y=!0),setTimeout((()=>{o(7,f.innerHTML=t.outerHTML,f)}),1);else if(e&&l&&l.left&&i){const t=l.left+i/2,o=i+_;W(n,[n.scrollLeft,n.scrollTop],[n.scrollLeft+(e<=t?-1:1)*o,n.scrollTop],300,L)}},B,()=>I(),function(e){A[e?"unshift":"push"]((()=>{n=e,o(4,n)}))},function(e){A[e?"unshift":"push"]((()=>{f=e,o(7,f)}))},()=>o(8,y=!1),()=>{z.set(!1)},()=>{o(9,k=!1),B()},()=>{o(9,k=!1),S.set([S[0],S[1],1])}]}export default class extends e{constructor(e){super(),t(this,e,se,Q,o,{content:0,book:1,chapter:2,nextChapterExists:3},[-1,-1])}}export{Z as preload};
