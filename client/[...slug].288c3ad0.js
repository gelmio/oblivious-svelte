import{S as t,i as e,s as o,e as s,c as a,b as r,f as l,h as n,j as c,l as i,B as u,a as h,t as f,E as d,v as p,d as m,g as b,k as v,m as g,y as x,z as y,F as w,r as E,H as k,I as T,Q as I,R as C,n as A,J as L,T as j,L as $,U as P,q as B,C as D}from"./client.5c93c126.js";import{r as N,g as V}from"./reader-hints.bab46389.js";function q(t,e,o,s,a=null){let r;const l=n=>{const c=n-r,i=c/s,u=[e[0]+(o[0]-e[0])*i,e[1]+(o[1]-e[1])*i];c<s?(t.scrollTo(u[0],u[1]),requestAnimationFrame(l)):(t.scrollTo(o[0],o[1]),a&&a())};requestAnimationFrame((t=>{r=t,l(t)}))}const{document:O,window:H}=C;function z(t){let e,o,d,p,g,x,y,w,E,k,T,I,C;return{c(){e=s("div"),o=s("p"),d=f("Congrats! You've made it to the end of Book 2!"),p=h(),g=s("p"),x=f("That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),y=h(),w=s("p"),E=f("While you wait, feel free to jump on the mailing list, or maybe even "),k=s("a"),T=f("buy me a coffee!"),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=r(e);o=a(s,"P",{});var n=r(o);d=b(n,"Congrats! You've made it to the end of Book 2!"),n.forEach(l),p=m(s),g=a(s,"P",{});var c=r(g);x=b(c,"That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),c.forEach(l),y=m(s),w=a(s,"P",{});var i=r(w);E=b(i,"While you wait, feel free to jump on the mailing list, or maybe even "),k=a(i,"A",{href:!0,rel:!0,class:!0});var u=r(k);T=b(u,"buy me a coffee!"),u.forEach(l),i.forEach(l),s.forEach(l),this.h()},h(){n(k,"href","https://transactions.sendowl.com/products/78458726/77A44CD1/add_to_cart"),n(k,"rel","nofollow"),n(k,"class","border-b border-oblivious-dark"),n(e,"class","text-center font-header mt-8")},m(t,s){c(t,e,s),v(e,o),v(o,d),v(e,p),v(e,g),v(g,x),v(e,y),v(e,w),v(w,E),v(w,k),v(k,T),I||(C=i(k,"click",Q),I=!0)},p:u,d(t){t&&l(e),I=!1,C()}}}function W(t){let e,o,u,d,p,x,y,w,E=t[3]?"Chapter":"Book",k=t[10][1]>10&&!(t[10][1]%5)&&M();return{c(){e=s("div"),o=s("a"),u=f("Next "),d=f(E),x=h(),k&&k.c(),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=r(e);o=a(s,"A",{rel:!0,href:!0,class:!0});var n=r(o);u=b(n,"Next "),d=b(n,E),n.forEach(l),x=m(s),k&&k.l(s),s.forEach(l),this.h()},h(){n(o,"rel","prefetch"),n(o,"href",p="read/"+t[10][0]+"/"+t[10][1]),n(o,"class","inline-block text-lg p-2 rounded-lg no-underline bg-oblivious mr-4"),n(e,"class","flex flex-col md:flex-row justify-end items-end mt-8")},m(t,s){c(t,e,s),v(e,o),v(o,u),v(o,d),v(e,x),k&&k.m(e,null),y||(w=i(o,"click",X),y=!0)},p(t,s){8&s[0]&&E!==(E=t[3]?"Chapter":"Book")&&g(d,E),1024&s[0]&&p!==(p="read/"+t[10][0]+"/"+t[10][1])&&n(o,"href",p),t[10][1]>10&&!(t[10][1]%5)?k||(k=M(),k.c(),k.m(e,null)):k&&(k.d(1),k=null)},d(t){t&&l(e),k&&k.d(),y=!1,w()}}}function M(t){let e,o,u,h,d,p;return{c(){e=s("span"),o=f("... or "),u=s("a"),h=f("buy me a coffee!"),this.h()},l(t){e=a(t,"SPAN",{class:!0});var s=r(e);o=b(s,"... or "),u=a(s,"A",{href:!0,rel:!0,class:!0});var n=r(u);h=b(n,"buy me a coffee!"),n.forEach(l),s.forEach(l),this.h()},h(){n(u,"href","https://transactions.sendowl.com/products/78458726/77A44CD1/add_to_cart"),n(u,"rel","nofollow"),n(u,"class","border-b border-oblivious-dark"),n(e,"class","m-2")},m(t,s){c(t,e,s),v(e,o),v(e,u),v(u,h),d||(p=i(u,"click",J),d=!0)},d(t){t&&l(e),d=!1,p()}}}function S(t){let e,o,h,f;return{c(){e=s("div"),this.h()},l(t){e=a(t,"DIV",{class:!0}),r(e).forEach(l),this.h()},h(){n(e,"class","fixed inset-0 flex justify-center items-center cursor-zoom-out bg-oblivious-opaque")},m(o,s){c(o,e,s),t[18](e),h||(f=i(e,"click",t[19]),h=!0)},p:u,i(t){o||A((()=>{o=L(e,B,{}),o.start()}))},o:u,d(o){o&&l(e),t[18](null),h=!1,f()}}}function G(t){let e,o,d,p,g,x,y,w,k,T,I,C,j,$;return{c(){e=s("div"),o=s("div"),d=s("p"),p=f("Want to jump to the last page you were reading?"),g=h(),x=s("div"),y=s("button"),w=f("Sure"),k=h(),T=s("button"),I=f("Nup"),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=r(e);o=a(s,"DIV",{class:!0});var n=r(o);d=a(n,"P",{class:!0});var c=r(d);p=b(c,"Want to jump to the last page you were reading?"),c.forEach(l),g=m(n),x=a(n,"DIV",{});var i=r(x);y=a(i,"BUTTON",{class:!0});var u=r(y);w=b(u,"Sure"),u.forEach(l),k=m(i),T=a(i,"BUTTON",{class:!0});var h=r(T);I=b(h,"Nup"),h.forEach(l),i.forEach(l),n.forEach(l),s.forEach(l),this.h()},h(){n(d,"class","font-sans text-base md:text-lg mb-4"),n(y,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious"),n(T,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-white border border-solid border-oblivious cursor-pointer"),n(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),n(e,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,a){c(s,e,a),v(e,o),v(o,d),v(d,p),v(o,g),v(o,x),v(x,y),v(y,w),v(x,k),v(x,T),v(T,I),j||($=[i(y,"click",t[21]),i(T,"click",t[22])],j=!0)},p:u,i(t){C||A((()=>{C=L(e,B,{delay:1e3}),C.start()}))},o:u,d(t){t&&l(e),j=!1,E($)}}}function Y(t){let e,o,d,p,g,x,y,w,E,k,T,I,C,j,$,P,N,V,q,O,H,z,W,M,S;return{c(){e=s("div"),o=s("div"),d=s("p"),p=f("Here's some tips:"),g=h(),x=s("p"),y=f("Tap the text to turn the pages."),w=h(),E=s("p"),k=f("Tap the images to zoom."),T=h(),I=s("p"),C=f("I'll help you out by keeping track of where you're up to."),j=h(),$=s("p"),P=f("I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),N=h(),V=s("div"),q=s("span"),O=f("Got it"),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=r(e);o=a(s,"DIV",{class:!0});var n=r(o);d=a(n,"P",{class:!0});var c=r(d);p=b(c,"Here's some tips:"),c.forEach(l),g=m(n),x=a(n,"P",{class:!0});var i=r(x);y=b(i,"Tap the text to turn the pages."),i.forEach(l),w=m(n),E=a(n,"P",{class:!0});var u=r(E);k=b(u,"Tap the images to zoom."),u.forEach(l),T=m(n),I=a(n,"P",{class:!0});var h=r(I);C=b(h,"I'll help you out by keeping track of where you're up to."),h.forEach(l),j=m(n),$=a(n,"P",{class:!0});var f=r($);P=b(f,"I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),f.forEach(l),N=m(n),V=a(n,"DIV",{});var v=r(V);q=a(v,"SPAN",{class:!0});var A=r(q);O=b(A,"Got it"),A.forEach(l),v.forEach(l),n.forEach(l),s.forEach(l),this.h()},h(){n(d,"class","font-header text-xl md:text-2xl mb-4"),n(x,"class","font-sans text-base md:text-lg mb-1"),n(E,"class","font-sans text-base md:text-lg mb-1"),n(I,"class","font-sans text-base md:text-lg mb-1"),n($,"class","font-sans text-base md:text-lg mb-1"),n(q,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious cursor-pointer"),n(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),n(e,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,a){c(s,e,a),v(e,o),v(o,d),v(d,p),v(o,g),v(o,x),v(x,y),v(o,w),v(o,E),v(E,k),v(o,T),v(o,I),v(I,C),v(o,j),v(o,$),v($,P),v(o,N),v(o,V),v(V,q),v(q,O),W=!0,M||(S=i(q,"click",t[20]),M=!0)},p:u,i(t){W||(A((()=>{z&&z.end(1),H||(H=L(e,B,{delay:1e3})),H.start()})),W=!0)},o(t){H&&H.invalidate(),z=D(e,B,{}),W=!1},d(t){t&&l(e),t&&z&&z.end(),M=!1,S()}}}function _(t){let e,o,u,k,T,I,C,A,L,P,B,D,N,V,q,M,_,F,R,X,J,Q,K,Z;function tt(t,e){return t[10][0]<3?W:z}O.title=e="Oblivious | Book "+t[1]+", Chapter "+t[2]+" | An overlanding motorbike journey through West Africa";let et=tt(t),ot=et(t),st=t[8]&&S(t);const at=[Y,G],rt=[];function lt(t,e){return t[11]?0:t[9]?1:-1}return~(R=lt(t))&&(X=rt[R]=at[R](t)),{c(){o=h(),u=s("article"),k=s("h2"),T=f("Book "),I=f(t[1]),C=f(", Chapter "),A=f(t[2]),L=h(),P=s("div"),D=h(),ot.c(),V=h(),q=s("div"),M=f("Oblivious | Luke Gelmi"),_=h(),st&&st.c(),F=h(),X&&X.c(),J=d(),this.h()},l(e){p('[data-svelte="svelte-1uu6ren"]',O.head).forEach(l),o=m(e),u=a(e,"ARTICLE",{class:!0});var s=r(u);k=a(s,"H2",{class:!0});var n=r(k);T=b(n,"Book "),I=b(n,t[1]),C=b(n,", Chapter "),A=b(n,t[2]),n.forEach(l),L=m(s),P=a(s,"DIV",{class:!0,style:!0});var c=r(P);D=m(c),ot.l(c),c.forEach(l),V=m(s),q=a(s,"DIV",{class:!0});var i=r(q);M=b(i,"Oblivious | Luke Gelmi"),i.forEach(l),s.forEach(l),_=m(e),st&&st.l(e),F=m(e),X&&X.l(e),J=d(),this.h()},h(){n(k,"class","font-header"),B=new j(D),n(P,"class","reader relative overflow-hidden no-scrollbar py-12 svelte-1hqhvkr"),n(P,"style",N=t[5]&&t[6]?`height: ${t[6]}px; columns: auto ${t[5]}px; column-gap: ${U}px; column-rule: 1px solid #000;`:""),n(q,"class","text-xs text-center -mt-10"),n(u,"class","prose md:prose-xl text-justify mb-8 md:mb-12 pt-16")},m(e,s){c(e,o,s),c(e,u,s),v(u,k),v(k,T),v(k,I),v(k,C),v(k,A),v(u,L),v(u,P),B.m(t[0],P),v(P,D),ot.m(P,null),t[17](P),v(u,V),v(u,q),v(q,M),c(e,_,s),st&&st.m(e,s),c(e,F,s),~R&&rt[R].m(e,s),c(e,J,s),Q=!0,K||(Z=[i(H,"resize",t[16]),i(P,"click",t[14])],K=!0)},p(t,o){(!Q||6&o[0])&&e!==(e="Oblivious | Book "+t[1]+", Chapter "+t[2]+" | An overlanding motorbike journey through West Africa")&&(O.title=e),(!Q||2&o[0])&&g(I,t[1]),(!Q||4&o[0])&&g(A,t[2]),(!Q||1&o[0])&&B.p(t[0]),et===(et=tt(t))&&ot?ot.p(t,o):(ot.d(1),ot=et(t),ot&&(ot.c(),ot.m(P,null))),(!Q||96&o[0]&&N!==(N=t[5]&&t[6]?`height: ${t[6]}px; columns: auto ${t[5]}px; column-gap: ${U}px; column-rule: 1px solid #000;`:""))&&n(P,"style",N),t[8]?st?(st.p(t,o),256&o[0]&&x(st,1)):(st=S(t),st.c(),x(st,1),st.m(F.parentNode,F)):st&&(st.d(1),st=null);let s=R;R=lt(t),R===s?~R&&rt[R].p(t,o):(X&&($(),y(rt[s],1,1,(()=>{rt[s]=null})),w()),~R?(X=rt[R],X||(X=rt[R]=at[R](t),X.c()),x(X,1),X.m(J.parentNode,J)):X=null)},i(t){Q||(x(st),x(X),Q=!0)},o(t){y(X),Q=!1},d(e){e&&l(o),e&&l(u),ot.d(),t[17](null),e&&l(_),st&&st.d(e),e&&l(F),~R&&rt[R].d(e),e&&l(J),K=!1,E(Z)}}}var F=function(t,e,o,s){return new(o||(o=Promise))((function(a,r){function l(t){try{c(s.next(t))}catch(t){r(t)}}function n(t){try{c(s.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(l,n)}c((s=s.apply(t,e||[])).next())}))};function R({params:t,query:e}){return F(this,void 0,void 0,(function*(){const[e,o]=t.slug.map((t=>+t)),s=yield this.fetch(`read/${e}/${o}.json`),{chapter:a,nextChapterExists:r,message:l}=yield s.json();if(200===s.status)return{content:a,book:e,chapter:o,nextChapterExists:r};this.error(s.status,l)}))}let U=50;const X=t=>t.stopPropagation(),J=t=>t.stopPropagation(),Q=t=>t.stopPropagation();function K(t,e,o){let s,a,r;k(t,N,(t=>o(30,a=t))),k(t,V,(t=>o(11,r=t)));let l,n,c,i,u,h,f,d,p,m,{content:b}=e,{book:v}=e,{chapter:g}=e,{nextChapterExists:x}=e,y=!1,w=!1;const{page:E}=T();function C(){l&&(c=[window.innerWidth,window.innerHeight],(!n||!u||!i||c[0]<i||c[1]<u||c[0]>i+100||c[1]>u+100)&&(o(6,u=Math.round(c[1])),n=l.getBoundingClientRect(),o(5,i=Math.round(n.width))))}k(t,E,(t=>o(29,s=t)));const A=(L=()=>{const t=l.scrollLeft;setTimeout((()=>{const e=l.scrollLeft%(i+U);if(t===l.scrollLeft&&e){const t=e/(i+U)<.5?-e:i+U-e;q(l,[l.scrollLeft,l.scrollTop],[l.scrollLeft+t,l.scrollLeft],300)}}),50)},j=1e3,function(){clearTimeout($),$=setTimeout((function(){L()}),j)});var L,j,$;function B(){const t=m[a[2]-1];t instanceof HTMLElement&&q(l,[l.scrollLeft,l.scrollTop],[t.offsetLeft,l.scrollTop],300,A)}function D(){m&&m.length>0&&(p=new IntersectionObserver((t=>{if(!0===t[0].isIntersecting){const e=Array.from(m).indexOf(t[0].target);e>-1&&e>a[2]-1&&N.set([O[0],O[1],e+1])}}),{threshold:[0]}),Array.from(m).forEach((t=>p.observe(t))))}I((()=>{var t,e;m=document.querySelectorAll(".reader p"),O&&(e=O,(!(t=a)||!t[0]||!t[1])&&e||e[0]>t[0]||e[0]===t[0]&&e[1]>t[1])?(N.set([O[0],O[1],1]),D()):a[0]===O[0]&&a[1]===O[1]&&a[2]>1?(o(9,w=!0),D()):a[0]===O[0]&&a[1]===O[1]&&1===a[2]&&D(),C(),setTimeout((()=>{C(),h=(window.pageYOffset||document.documentElement.scrollTop)+n.top,q(window,[window.scrollX,window.scrollY],[window.scrollX,h],600)}),2e3)}));let O;return t.$$set=t=>{"content"in t&&o(0,b=t.content),"book"in t&&o(1,v=t.book),"chapter"in t&&o(2,g=t.chapter),"nextChapterExists"in t&&o(3,x=t.nextChapterExists)},t.$$.update=()=>{536870912&t.$$.dirty[0]&&(O=s.params.slug?s.params.slug.map((t=>+t)):null),14&t.$$.dirty[0]&&o(10,d=!x&&v<3?[v+1,1]:[v,g+1])},[b,v,g,x,l,i,u,f,y,w,d,r,E,C,({clientX:t,target:e})=>{if("IMG"===e.tagName)o(8,y=!0),setTimeout((()=>{o(7,f.innerHTML=e.outerHTML,f)}),1);else if(t&&n&&n.left&&i){const e=n.left+i/2,o=i+U;q(l,[l.scrollLeft,l.scrollTop],[l.scrollLeft+(t<=e?-1:1)*o,l.scrollTop],300,A)}},B,()=>C(),function(t){P[t?"unshift":"push"]((()=>{l=t,o(4,l)}))},function(t){P[t?"unshift":"push"]((()=>{f=t,o(7,f)}))},()=>o(8,y=!1),()=>{V.set(!1)},()=>{o(9,w=!1),B()},()=>{o(9,w=!1),N.set([N[0],N[1],1])}]}export default class extends t{constructor(t){super(),e(this,t,K,_,o,{content:0,book:1,chapter:2,nextChapterExists:3},[-1,-1])}}export{R as preload};
