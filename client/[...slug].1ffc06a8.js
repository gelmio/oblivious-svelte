import{S as e,i as t,s as o,e as s,c as r,b as a,f as l,h as n,j as i,l as c,B as u,a as h,t as f,E as d,v as p,d as m,g as b,k as v,m as g,y as x,z as y,F as w,r as E,H as k,I as T,Q as I,R as C,n as L,J as j,T as $,L as A,U as B,q as P,C as D}from"./client.908cdcb7.js";import{r as O,g as V}from"./reader-hints.e2b7a9ff.js";function H(e,t,o,s,r=null){let a;const l=n=>{const i=n-a,c=i/s,u=[t[0]+(o[0]-t[0])*c,t[1]+(o[1]-t[1])*c];i<s?(e.scrollTo(u[0],u[1]),requestAnimationFrame(l)):(e.scrollTo(o[0],o[1]),r&&r())};requestAnimationFrame((e=>{a=e,l(e)}))}const{document:N,window:q}=C;function z(e){let t,o,d,p,g,x,y,w,E,k,T,I,C;return{c(){t=s("div"),o=s("p"),d=f("Congrats! You've made it to the end of Book 2!"),p=h(),g=s("p"),x=f("That's as far as things go for the moment, but Book 3 is on the way\n          out soon!"),y=h(),w=s("p"),E=f("While you wait, feel free to jump on the mailing list, or maybe even "),k=s("a"),T=f("buy me a coffee!"),this.h()},l(e){t=r(e,"DIV",{class:!0});var s=a(t);o=r(s,"P",{});var n=a(o);d=b(n,"Congrats! You've made it to the end of Book 2!"),n.forEach(l),p=m(s),g=r(s,"P",{});var i=a(g);x=b(i,"That's as far as things go for the moment, but Book 3 is on the way\n          out soon!"),i.forEach(l),y=m(s),w=r(s,"P",{});var c=a(w);E=b(c,"While you wait, feel free to jump on the mailing list, or maybe even "),k=r(c,"A",{href:!0,rel:!0,class:!0});var u=a(k);T=b(u,"buy me a coffee!"),u.forEach(l),c.forEach(l),s.forEach(l),this.h()},h(){n(k,"href","https://payhip.com/b/5eyXH"),n(k,"rel","nofollow"),n(k,"class","border-b border-oblivious-dark"),n(t,"class","text-center font-header mt-8")},m(e,s){i(e,t,s),v(t,o),v(o,d),v(t,p),v(t,g),v(g,x),v(t,y),v(t,w),v(w,E),v(w,k),v(k,T),I||(C=c(k,"click",K),I=!0)},p:u,d(e){e&&l(t),I=!1,C()}}}function W(e){let t,o,u,d,p,x,y,w,E=e[3]?"Chapter":"Book",k=e[10][1]>10&&!(e[10][1]%5)&&M();return{c(){t=s("div"),o=s("a"),u=f("Next "),d=f(E),x=h(),k&&k.c(),this.h()},l(e){t=r(e,"DIV",{class:!0});var s=a(t);o=r(s,"A",{rel:!0,href:!0,class:!0});var n=a(o);u=b(n,"Next "),d=b(n,E),n.forEach(l),x=m(s),k&&k.l(s),s.forEach(l),this.h()},h(){n(o,"rel","prefetch"),n(o,"href",p="read/"+e[10][0]+"/"+e[10][1]),n(o,"class","inline-block text-lg p-2 rounded-lg no-underline bg-oblivious"),n(t,"class","flex flex-col md:flex-row justify-end items-end mt-8")},m(e,s){i(e,t,s),v(t,o),v(o,u),v(o,d),v(t,x),k&&k.m(t,null),y||(w=c(o,"click",J),y=!0)},p(e,s){8&s[0]&&E!==(E=e[3]?"Chapter":"Book")&&g(d,E),1024&s[0]&&p!==(p="read/"+e[10][0]+"/"+e[10][1])&&n(o,"href",p),e[10][1]>10&&!(e[10][1]%5)?k||(k=M(),k.c(),k.m(t,null)):k&&(k.d(1),k=null)},d(e){e&&l(t),k&&k.d(),y=!1,w()}}}function M(e){let t,o,u,h;return{c(){t=s("a"),o=f("Or buy me a coffee!"),this.h()},l(e){t=r(e,"A",{href:!0,rel:!0,class:!0});var s=a(t);o=b(s,"Or buy me a coffee!"),s.forEach(l),this.h()},h(){n(t,"href","https://payhip.com/b/5eyXH"),n(t,"rel","nofollow"),n(t,"class","inline-block text-lg p-2 mx-4 rounded-lg no-underline bg-white border border-solid border-oblivious")},m(e,s){i(e,t,s),v(t,o),u||(h=c(t,"click",Q),u=!0)},d(e){e&&l(t),u=!1,h()}}}function G(e){let t,o,h,f;return{c(){t=s("div"),this.h()},l(e){t=r(e,"DIV",{class:!0}),a(t).forEach(l),this.h()},h(){n(t,"class","fixed inset-0 flex justify-center items-center cursor-zoom-out bg-oblivious-opaque")},m(o,s){i(o,t,s),e[18](t),h||(f=c(t,"click",e[19]),h=!0)},p:u,i(e){o||L((()=>{o=j(t,P,{}),o.start()}))},o:u,d(o){o&&l(t),e[18](null),h=!1,f()}}}function S(e){let t,o,d,p,g,x,y,w,k,T,I,C,$,A;return{c(){t=s("div"),o=s("div"),d=s("p"),p=f("Want to jump to the last page you were reading?"),g=h(),x=s("div"),y=s("button"),w=f("Sure"),k=h(),T=s("button"),I=f("Nup"),this.h()},l(e){t=r(e,"DIV",{class:!0});var s=a(t);o=r(s,"DIV",{class:!0});var n=a(o);d=r(n,"P",{class:!0});var i=a(d);p=b(i,"Want to jump to the last page you were reading?"),i.forEach(l),g=m(n),x=r(n,"DIV",{});var c=a(x);y=r(c,"BUTTON",{class:!0});var u=a(y);w=b(u,"Sure"),u.forEach(l),k=m(c),T=r(c,"BUTTON",{class:!0});var h=a(T);I=b(h,"Nup"),h.forEach(l),c.forEach(l),n.forEach(l),s.forEach(l),this.h()},h(){n(d,"class","font-sans text-base md:text-lg mb-4"),n(y,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious"),n(T,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-white border border-solid border-oblivious cursor-pointer"),n(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),n(t,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,r){i(s,t,r),v(t,o),v(o,d),v(d,p),v(o,g),v(o,x),v(x,y),v(y,w),v(x,k),v(x,T),v(T,I),$||(A=[c(y,"click",e[21]),c(T,"click",e[22])],$=!0)},p:u,i(e){C||L((()=>{C=j(t,P,{delay:1e3}),C.start()}))},o:u,d(e){e&&l(t),$=!1,E(A)}}}function X(e){let t,o,d,p,g,x,y,w,E,k,T,I,C,$,A,B,O,V,H,N,q,z,W,M,G;return{c(){t=s("div"),o=s("div"),d=s("p"),p=f("Here's some tips:"),g=h(),x=s("p"),y=f("Tap the text to turn the pages."),w=h(),E=s("p"),k=f("Tap the images to zoom."),T=h(),I=s("p"),C=f("I'll help you out by keeping track of where you're up to."),$=h(),A=s("p"),B=f("I'll also scroll automatically to where the pages are so you don't have\n        to bother your finger..."),O=h(),V=s("div"),H=s("span"),N=f("Got it"),this.h()},l(e){t=r(e,"DIV",{class:!0});var s=a(t);o=r(s,"DIV",{class:!0});var n=a(o);d=r(n,"P",{class:!0});var i=a(d);p=b(i,"Here's some tips:"),i.forEach(l),g=m(n),x=r(n,"P",{class:!0});var c=a(x);y=b(c,"Tap the text to turn the pages."),c.forEach(l),w=m(n),E=r(n,"P",{class:!0});var u=a(E);k=b(u,"Tap the images to zoom."),u.forEach(l),T=m(n),I=r(n,"P",{class:!0});var h=a(I);C=b(h,"I'll help you out by keeping track of where you're up to."),h.forEach(l),$=m(n),A=r(n,"P",{class:!0});var f=a(A);B=b(f,"I'll also scroll automatically to where the pages are so you don't have\n        to bother your finger..."),f.forEach(l),O=m(n),V=r(n,"DIV",{});var v=a(V);H=r(v,"SPAN",{class:!0});var L=a(H);N=b(L,"Got it"),L.forEach(l),v.forEach(l),n.forEach(l),s.forEach(l),this.h()},h(){n(d,"class","font-header text-xl md:text-2xl mb-4"),n(x,"class","font-sans text-base md:text-lg mb-1"),n(E,"class","font-sans text-base md:text-lg mb-1"),n(I,"class","font-sans text-base md:text-lg mb-1"),n(A,"class","font-sans text-base md:text-lg mb-1"),n(H,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious cursor-pointer"),n(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),n(t,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,r){i(s,t,r),v(t,o),v(o,d),v(d,p),v(o,g),v(o,x),v(x,y),v(o,w),v(o,E),v(E,k),v(o,T),v(o,I),v(I,C),v(o,$),v(o,A),v(A,B),v(o,O),v(o,V),v(V,H),v(H,N),W=!0,M||(G=c(H,"click",e[20]),M=!0)},p:u,i(e){W||(L((()=>{z&&z.end(1),q||(q=j(t,P,{delay:1e3})),q.start()})),W=!0)},o(e){q&&q.invalidate(),z=D(t,P,{}),W=!1},d(e){e&&l(t),e&&z&&z.end(),M=!1,G()}}}function Y(e){let t,o,u,k,T,I,C,L,j,B,P,D,O,V,H,M,Y,F,R,J,Q,K,Z,_;function ee(e,t){return e[10][0]<3?W:z}N.title=t="Oblivious | Book "+e[1]+", Chapter "+e[2]+" | An overlanding motorbike journey\n    through West Africa";let te=ee(e),oe=te(e),se=e[8]&&G(e);const re=[X,S],ae=[];function le(e,t){return e[11]?0:e[9]?1:-1}return~(R=le(e))&&(J=ae[R]=re[R](e)),{c(){o=h(),u=s("article"),k=s("h2"),T=f("Book "),I=f(e[1]),C=f(", Chapter "),L=f(e[2]),j=h(),B=s("div"),D=h(),oe.c(),V=h(),H=s("div"),M=f("Oblivious | Luke Gelmi"),Y=h(),se&&se.c(),F=h(),J&&J.c(),Q=d(),this.h()},l(t){p('[data-svelte="svelte-hd4i7p"]',N.head).forEach(l),o=m(t),u=r(t,"ARTICLE",{class:!0});var s=a(u);k=r(s,"H2",{class:!0});var n=a(k);T=b(n,"Book "),I=b(n,e[1]),C=b(n,", Chapter "),L=b(n,e[2]),n.forEach(l),j=m(s),B=r(s,"DIV",{class:!0,style:!0});var i=a(B);D=m(i),oe.l(i),i.forEach(l),V=m(s),H=r(s,"DIV",{class:!0});var c=a(H);M=b(c,"Oblivious | Luke Gelmi"),c.forEach(l),s.forEach(l),Y=m(t),se&&se.l(t),F=m(t),J&&J.l(t),Q=d(),this.h()},h(){n(k,"class","font-header"),P=new $(D),n(B,"class","reader relative overflow-hidden no-scrollbar py-12 svelte-1hqhvkr"),n(B,"style",O=e[5]&&e[6]?`height: ${e[6]}px; columns: auto ${e[5]}px; column-gap: ${U}px; column-rule: 1px solid #000;`:""),n(H,"class","text-xs text-center -mt-10"),n(u,"class","prose md:prose-xl text-justify mb-8 md:mb-12 pt-16")},m(t,s){i(t,o,s),i(t,u,s),v(u,k),v(k,T),v(k,I),v(k,C),v(k,L),v(u,j),v(u,B),P.m(e[0],B),v(B,D),oe.m(B,null),e[17](B),v(u,V),v(u,H),v(H,M),i(t,Y,s),se&&se.m(t,s),i(t,F,s),~R&&ae[R].m(t,s),i(t,Q,s),K=!0,Z||(_=[c(q,"resize",e[16]),c(B,"click",e[14])],Z=!0)},p(e,o){(!K||6&o[0])&&t!==(t="Oblivious | Book "+e[1]+", Chapter "+e[2]+" | An overlanding motorbike journey\n    through West Africa")&&(N.title=t),(!K||2&o[0])&&g(I,e[1]),(!K||4&o[0])&&g(L,e[2]),(!K||1&o[0])&&P.p(e[0]),te===(te=ee(e))&&oe?oe.p(e,o):(oe.d(1),oe=te(e),oe&&(oe.c(),oe.m(B,null))),(!K||96&o[0]&&O!==(O=e[5]&&e[6]?`height: ${e[6]}px; columns: auto ${e[5]}px; column-gap: ${U}px; column-rule: 1px solid #000;`:""))&&n(B,"style",O),e[8]?se?(se.p(e,o),256&o[0]&&x(se,1)):(se=G(e),se.c(),x(se,1),se.m(F.parentNode,F)):se&&(se.d(1),se=null);let s=R;R=le(e),R===s?~R&&ae[R].p(e,o):(J&&(A(),y(ae[s],1,1,(()=>{ae[s]=null})),w()),~R?(J=ae[R],J||(J=ae[R]=re[R](e),J.c()),x(J,1),J.m(Q.parentNode,Q)):J=null)},i(e){K||(x(se),x(J),K=!0)},o(e){y(J),K=!1},d(t){t&&l(o),t&&l(u),oe.d(),e[17](null),t&&l(Y),se&&se.d(t),t&&l(F),~R&&ae[R].d(t),t&&l(Q),Z=!1,E(_)}}}var F=function(e,t,o,s){return new(o||(o=Promise))((function(r,a){function l(e){try{i(s.next(e))}catch(e){a(e)}}function n(e){try{i(s.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,n)}i((s=s.apply(e,t||[])).next())}))};function R({params:e,query:t}){return F(this,void 0,void 0,(function*(){const[t,o]=e.slug.map((e=>+e)),s=yield this.fetch(`read/${t}/${o}.json`),{chapter:r,nextChapterExists:a,message:l}=yield s.json();if(200===s.status)return{content:r,book:t,chapter:o,nextChapterExists:a};this.error(s.status,l)}))}let U=50;const J=e=>e.stopPropagation(),Q=e=>e.stopPropagation(),K=e=>e.stopPropagation();function Z(e,t,o){let s,r,a;k(e,O,(e=>o(30,r=e))),k(e,V,(e=>o(11,a=e)));let l,n,i,c,u,h,f,d,p,m,{content:b}=t,{book:v}=t,{chapter:g}=t,{nextChapterExists:x}=t,y=!1,w=!1;const{page:E}=T();function C(){l&&(i=[window.innerWidth,window.innerHeight],(!n||!u||!c||i[0]<c||i[1]<u||i[0]>c+100||i[1]>u+100)&&(o(6,u=Math.round(i[1])),n=l.getBoundingClientRect(),o(5,c=Math.round(n.width))))}k(e,E,(e=>o(29,s=e)));const L=(j=()=>{const e=l.scrollLeft;setTimeout((()=>{const t=l.scrollLeft%(c+U);if(e===l.scrollLeft&&t){const e=t/(c+U)<.5?-t:c+U-t;H(l,[l.scrollLeft,l.scrollTop],[l.scrollLeft+e,l.scrollLeft],300)}}),50)},$=1e3,function(){clearTimeout(A),A=setTimeout((function(){j()}),$)});var j,$,A;function P(){const e=m[r[2]-1];e instanceof HTMLElement&&H(l,[l.scrollLeft,l.scrollTop],[e.offsetLeft,l.scrollTop],300,L)}function D(){m&&m.length>0&&(p=new IntersectionObserver((e=>{if(!0===e[0].isIntersecting){const t=Array.from(m).indexOf(e[0].target);t>-1&&t>r[2]-1&&O.set([N[0],N[1],t+1])}}),{threshold:[0]}),Array.from(m).forEach((e=>p.observe(e))))}I((()=>{var e,t;m=document.querySelectorAll(".reader p"),N&&(t=N,(!(e=r)||!e[0]||!e[1])&&t||t[0]>e[0]||t[0]===e[0]&&t[1]>e[1])?(O.set([N[0],N[1],1]),D()):r[0]===N[0]&&r[1]===N[1]&&r[2]>1?(o(9,w=!0),D()):r[0]===N[0]&&r[1]===N[1]&&1===r[2]&&D(),C(),setTimeout((()=>{C(),h=(window.pageYOffset||document.documentElement.scrollTop)+n.top,H(window,[window.scrollX,window.scrollY],[window.scrollX,h],600)}),2e3)}));let N;return e.$$set=e=>{"content"in e&&o(0,b=e.content),"book"in e&&o(1,v=e.book),"chapter"in e&&o(2,g=e.chapter),"nextChapterExists"in e&&o(3,x=e.nextChapterExists)},e.$$.update=()=>{536870912&e.$$.dirty[0]&&(N=s.params.slug?s.params.slug.map((e=>+e)):null),14&e.$$.dirty[0]&&o(10,d=!x&&v<3?[v+1,1]:[v,g+1])},[b,v,g,x,l,c,u,f,y,w,d,a,E,C,({clientX:e,target:t})=>{if("IMG"===t.tagName)o(8,y=!0),setTimeout((()=>{o(7,f.innerHTML=t.outerHTML,f)}),1);else if(e&&n&&n.left&&c){const t=n.left+c/2,o=c+U;H(l,[l.scrollLeft,l.scrollTop],[l.scrollLeft+(e<=t?-1:1)*o,l.scrollTop],300,L)}},P,()=>C(),function(e){B[e?"unshift":"push"]((()=>{l=e,o(4,l)}))},function(e){B[e?"unshift":"push"]((()=>{f=e,o(7,f)}))},()=>o(8,y=!1),()=>{V.set(!1)},()=>{o(9,w=!1),P()},()=>{o(9,w=!1),O.set([O[0],O[1],1])}]}export default class extends e{constructor(e){super(),t(this,e,Z,Y,o,{content:0,book:1,chapter:2,nextChapterExists:3},[-1,-1])}}export{R as preload};
