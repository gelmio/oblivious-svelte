import{S as e,i as t,s as o,e as s,c as r,b as a,f as n,h as l,j as i,l as c,y as h,a as u,t as f,D as d,v as p,d as m,g as v,k as x,m as b,z as g,A as y,E as k,r as w,G as E,H as T,O as I,Q as A,n as C,I as L,R as j,K as $,T as D,q as B,C as P}from"./client.847c20bf.js";import{r as N,g as V}from"./reader-hints.ed7fa2f6.js";function O(e,t,o,s,r=null){let a;const n=l=>{const i=l-a,c=i/s,h=[t[0]+(o[0]-t[0])*c,t[1]+(o[1]-t[1])*c];i<s?(e.scrollTo(h[0],h[1]),requestAnimationFrame(n)):(e.scrollTo(o[0],o[1]),r&&r())};requestAnimationFrame((e=>{a=e,n(e)}))}const{document:q,window:H}=A;function z(e){let t,o,c,d,p,b,g,y,k,w,E;return{c(){t=s("div"),o=s("p"),c=f("Congrats! You've made it to the end of Book 2!"),d=u(),p=s("p"),b=f("That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),g=u(),y=s("p"),k=f("While you wait, feel free to jump on the mailing list, or "),w=s("a"),E=f("flick me some money to keep the wheels rolling!"),this.h()},l(e){t=r(e,"DIV",{class:!0});var s=a(t);o=r(s,"P",{});var l=a(o);c=v(l,"Congrats! You've made it to the end of Book 2!"),l.forEach(n),d=m(s),p=r(s,"P",{});var i=a(p);b=v(i,"That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),i.forEach(n),g=m(s),y=r(s,"P",{});var h=a(y);k=v(h,"While you wait, feel free to jump on the mailing list, or "),w=r(h,"A",{href:!0,rel:!0,class:!0});var u=a(w);E=v(u,"flick me some money to keep the wheels rolling!"),u.forEach(n),h.forEach(n),s.forEach(n),this.h()},h(){l(w,"href","https://transactions.sendowl.com/products/78458726/77A44CD1/add_to_cart"),l(w,"rel","nofollow"),l(w,"class","border-b border-oblivious-dark"),l(t,"class","text-center font-header mt-8")},m(e,s){i(e,t,s),x(t,o),x(o,c),x(t,d),x(t,p),x(p,b),x(t,g),x(t,y),x(y,k),x(y,w),x(w,E)},p:h,d(e){e&&n(t)}}}function M(e){let t,o,c,h,d,p,g=e[4]?"Chapter":"Book",y=e[11][1]>10&&!(e[11][1]%5)&&W();return{c(){t=s("div"),o=s("a"),c=f("Next "),h=f(g),p=u(),y&&y.c(),this.h()},l(e){t=r(e,"DIV",{class:!0});var s=a(t);o=r(s,"A",{rel:!0,href:!0,class:!0});var l=a(o);c=v(l,"Next "),h=v(l,g),l.forEach(n),p=m(s),y&&y.l(s),s.forEach(n),this.h()},h(){l(o,"rel","prefetch"),l(o,"href",d="read/"+e[11][0]+"/"+e[11][1]),l(o,"class","inline-block text-lg p-2 rounded-lg no-underline bg-oblivious mr-4"),l(t,"class","flex flex-col md:flex-row justify-end items-end mt-8")},m(e,s){i(e,t,s),x(t,o),x(o,c),x(o,h),x(t,p),y&&y.m(t,null)},p(e,s){16&s[0]&&g!==(g=e[4]?"Chapter":"Book")&&b(h,g),2048&s[0]&&d!==(d="read/"+e[11][0]+"/"+e[11][1])&&l(o,"href",d),e[11][1]>10&&!(e[11][1]%5)?y||(y=W(),y.c(),y.m(t,null)):y&&(y.d(1),y=null)},d(e){e&&n(t),y&&y.d()}}}function W(e){let t,o,c,h;return{c(){t=s("span"),o=f("... or "),c=s("a"),h=f("flick me some money!"),this.h()},l(e){t=r(e,"SPAN",{class:!0});var s=a(t);o=v(s,"... or "),c=r(s,"A",{href:!0,rel:!0,class:!0});var l=a(c);h=v(l,"flick me some money!"),l.forEach(n),s.forEach(n),this.h()},h(){l(c,"href","https://transactions.sendowl.com/products/78458726/77A44CD1/add_to_cart"),l(c,"rel","nofollow"),l(c,"class","border-b border-oblivious-dark"),l(t,"class","m-2")},m(e,s){i(e,t,s),x(t,o),x(t,c),x(c,h)},d(e){e&&n(t)}}}function G(e){let t,o,u,f;return{c(){t=s("div"),this.h()},l(e){t=r(e,"DIV",{class:!0}),a(t).forEach(n),this.h()},h(){l(t,"class","fixed inset-0 flex justify-center items-center cursor-zoom-out bg-oblivious-opaque")},m(o,s){i(o,t,s),e[19](t),u||(f=c(t,"click",e[20]),u=!0)},p:h,i(e){o||C((()=>{o=L(t,B,{}),o.start()}))},o:h,d(o){o&&n(t),e[19](null),u=!1,f()}}}function S(e){let t,o,d,p,b,g,y,k,E,T,I,A,j,$,D,N,V,O,q;return{c(){t=s("div"),o=s("div"),d=s("p"),p=f("Looks like you've been here before..."),b=u(),g=s("p"),y=f("Want to jump to the last page you were reading?"),k=u(),E=s("div"),T=s("button"),I=f("Sure"),A=u(),j=s("button"),$=f("Nup"),this.h()},l(e){t=r(e,"DIV",{class:!0});var s=a(t);o=r(s,"DIV",{class:!0});var l=a(o);d=r(l,"P",{class:!0});var i=a(d);p=v(i,"Looks like you've been here before..."),i.forEach(n),b=m(l),g=r(l,"P",{class:!0});var c=a(g);y=v(c,"Want to jump to the last page you were reading?"),c.forEach(n),k=m(l),E=r(l,"DIV",{});var h=a(E);T=r(h,"BUTTON",{class:!0});var u=a(T);I=v(u,"Sure"),u.forEach(n),A=m(h),j=r(h,"BUTTON",{class:!0});var f=a(j);$=v(f,"Nup"),f.forEach(n),h.forEach(n),l.forEach(n),s.forEach(n),this.h()},h(){l(d,"class","font-header text-xl md:text-2xl"),l(g,"class","font-sans text-base md:text-lg mb-4"),l(T,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious"),l(j,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-white border border-solid border-oblivious cursor-pointer"),l(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),l(t,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,r){i(s,t,r),x(t,o),x(o,d),x(d,p),x(o,b),x(o,g),x(g,y),x(o,k),x(o,E),x(E,T),x(T,I),x(E,A),x(E,j),x(j,$),V=!0,O||(q=[c(T,"click",e[22]),c(j,"click",e[23])],O=!0)},p:h,i(e){V||(C((()=>{N&&N.end(1),D||(D=L(t,B,{delay:1e3})),D.start()})),V=!0)},o(e){D&&D.invalidate(),N=P(t,B,{}),V=!1},d(e){e&&n(t),e&&N&&N.end(),O=!1,w(q)}}}function Y(e){let t,o,d,p,b,g,y,k,w,E,T,I,A,j,$,D,N,V,O,q,H,z,M,W,G;return{c(){t=s("div"),o=s("div"),d=s("p"),p=f("Here's some tips:"),b=u(),g=s("p"),y=f("Tap the text to turn the pages."),k=u(),w=s("p"),E=f("Tap the images to zoom."),T=u(),I=s("p"),A=f("I'll help you out by keeping track of where you're up to."),j=u(),$=s("p"),D=f("I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),N=u(),V=s("div"),O=s("span"),q=f("Got it"),this.h()},l(e){t=r(e,"DIV",{class:!0});var s=a(t);o=r(s,"DIV",{class:!0});var l=a(o);d=r(l,"P",{class:!0});var i=a(d);p=v(i,"Here's some tips:"),i.forEach(n),b=m(l),g=r(l,"P",{class:!0});var c=a(g);y=v(c,"Tap the text to turn the pages."),c.forEach(n),k=m(l),w=r(l,"P",{class:!0});var h=a(w);E=v(h,"Tap the images to zoom."),h.forEach(n),T=m(l),I=r(l,"P",{class:!0});var u=a(I);A=v(u,"I'll help you out by keeping track of where you're up to."),u.forEach(n),j=m(l),$=r(l,"P",{class:!0});var f=a($);D=v(f,"I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),f.forEach(n),N=m(l),V=r(l,"DIV",{});var x=a(V);O=r(x,"SPAN",{class:!0});var C=a(O);q=v(C,"Got it"),C.forEach(n),x.forEach(n),l.forEach(n),s.forEach(n),this.h()},h(){l(d,"class","font-header text-xl md:text-2xl mb-4"),l(g,"class","font-sans text-base md:text-lg mb-1"),l(w,"class","font-sans text-base md:text-lg mb-1"),l(I,"class","font-sans text-base md:text-lg mb-1"),l($,"class","font-sans text-base md:text-lg mb-1"),l(O,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious cursor-pointer"),l(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),l(t,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,r){i(s,t,r),x(t,o),x(o,d),x(d,p),x(o,b),x(o,g),x(g,y),x(o,k),x(o,w),x(w,E),x(o,T),x(o,I),x(I,A),x(o,j),x(o,$),x($,D),x(o,N),x(o,V),x(V,O),x(O,q),M=!0,W||(G=c(O,"click",e[21]),W=!0)},p:h,i(e){M||(C((()=>{z&&z.end(1),H||(H=L(t,B,{delay:1e3})),H.start()})),M=!0)},o(e){H&&H.invalidate(),z=P(t,B,{}),M=!1},d(e){e&&n(t),e&&z&&z.end(),W=!1,G()}}}function _(e){let t,o,h,E,T,I,A,C,L,D,B,P,N,V,O,W,_,R,X,U,K,Q,J,Z,ee;function te(e,t){return e[11][0]<3?M:z}q.title=t="Oblivious | Book "+e[2]+", Chapter "+e[3]+" | An overlanding motorbike journey\n\t\tthrough West Africa";let oe=te(e),se=oe(e),re=e[9]&&G(e);const ae=[Y,S],ne=[];function le(e,t){return e[12]?0:e[10]?1:-1}return~(U=le(e))&&(K=ne[U]=ae[U](e)),{c(){o=s("meta"),h=u(),E=s("article"),T=s("h2"),I=f("Book "),A=f(e[2]),C=f(", Chapter "),L=f(e[3]),D=u(),B=s("div"),N=u(),se.c(),O=u(),W=s("div"),_=f("Oblivious | Luke Gelmi"),R=u(),re&&re.c(),X=u(),K&&K.c(),Q=d(),this.h()},l(t){const s=p('[data-svelte="svelte-jk3wt5"]',q.head);o=r(s,"META",{name:!0,content:!0}),s.forEach(n),h=m(t),E=r(t,"ARTICLE",{class:!0});var l=a(E);T=r(l,"H2",{class:!0});var i=a(T);I=v(i,"Book "),A=v(i,e[2]),C=v(i,", Chapter "),L=v(i,e[3]),i.forEach(n),D=m(l),B=r(l,"DIV",{class:!0,style:!0});var c=a(B);N=m(c),se.l(c),c.forEach(n),O=m(l),W=r(l,"DIV",{class:!0});var u=a(W);_=v(u,"Oblivious | Luke Gelmi"),u.forEach(n),l.forEach(n),R=m(t),re&&re.l(t),X=m(t),K&&K.l(t),Q=d(),this.h()},h(){l(o,"name","description"),l(o,"content",e[1]),l(T,"class","font-header"),P=new j(N),l(B,"class","reader relative overflow-hidden no-scrollbar py-12 svelte-1hqhvkr"),l(B,"style",V=e[6]&&e[7]?`height: ${e[7]}px; columns: auto ${e[6]}px; column-gap: ${F}px; column-rule: 1px solid #000;`:""),l(W,"class","text-xs text-center -mt-10"),l(E,"class","prose md:prose-xl text-justify mb-8 md:mb-12 pt-16")},m(t,s){x(q.head,o),i(t,h,s),i(t,E,s),x(E,T),x(T,I),x(T,A),x(T,C),x(T,L),x(E,D),x(E,B),P.m(e[0],B),x(B,N),se.m(B,null),e[18](B),x(E,O),x(E,W),x(W,_),i(t,R,s),re&&re.m(t,s),i(t,X,s),~U&&ne[U].m(t,s),i(t,Q,s),J=!0,Z||(ee=[c(H,"resize",e[17]),c(B,"click",e[15])],Z=!0)},p(e,s){(!J||12&s[0])&&t!==(t="Oblivious | Book "+e[2]+", Chapter "+e[3]+" | An overlanding motorbike journey\n\t\tthrough West Africa")&&(q.title=t),(!J||2&s[0])&&l(o,"content",e[1]),(!J||4&s[0])&&b(A,e[2]),(!J||8&s[0])&&b(L,e[3]),(!J||1&s[0])&&P.p(e[0]),oe===(oe=te(e))&&se?se.p(e,s):(se.d(1),se=oe(e),se&&(se.c(),se.m(B,null))),(!J||192&s[0]&&V!==(V=e[6]&&e[7]?`height: ${e[7]}px; columns: auto ${e[6]}px; column-gap: ${F}px; column-rule: 1px solid #000;`:""))&&l(B,"style",V),e[9]?re?(re.p(e,s),512&s[0]&&g(re,1)):(re=G(e),re.c(),g(re,1),re.m(X.parentNode,X)):re&&(re.d(1),re=null);let r=U;U=le(e),U===r?~U&&ne[U].p(e,s):(K&&($(),y(ne[r],1,1,(()=>{ne[r]=null})),k()),~U?(K=ne[U],K||(K=ne[U]=ae[U](e),K.c()),g(K,1),K.m(Q.parentNode,Q)):K=null)},i(e){J||(g(re),g(K),J=!0)},o(e){y(K),J=!1},d(t){n(o),t&&n(h),t&&n(E),se.d(),e[18](null),t&&n(R),re&&re.d(t),t&&n(X),~U&&ne[U].d(t),t&&n(Q),Z=!1,w(ee)}}}var R=function(e,t,o,s){return new(o||(o=Promise))((function(r,a){function n(e){try{i(s.next(e))}catch(e){a(e)}}function l(e){try{i(s.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(n,l)}i((s=s.apply(e,t||[])).next())}))};function X({params:e,query:t}){return R(this,void 0,void 0,(function*(){const[t,o]=e.slug.map((e=>+e)),s=yield this.fetch(`read/${t}/${o}.json`),{chapter:r,snippet:a,nextChapterExists:n,message:l}=yield s.json();if(200===s.status)return{content:r,snippet:a,book:t,chapter:o,nextChapterExists:n};this.error(s.status,l)}))}let F=50;function U(e,t,o){let s,r,a;E(e,N,(e=>o(31,r=e))),E(e,V,(e=>o(12,a=e)));let n,l,i,c,h,u,f,d,p,m,{content:v}=t,{snippet:x}=t,{book:b}=t,{chapter:g}=t,{nextChapterExists:y}=t,k=!1,w=!1;const{page:A}=T();function C(){i=[window.innerWidth,window.innerHeight],(!l||!h||!c||i[0]<c||i[1]<h||i[0]>c+100||i[1]>h+100)&&(o(7,h=Math.round(i[1])),l=n.getBoundingClientRect(),o(6,c=Math.round(l.width)))}E(e,A,(e=>o(30,s=e)));const L=(j=()=>{const e=n.scrollLeft;setTimeout((()=>{const t=n.scrollLeft%(c+F);if(e===n.scrollLeft&&t){const e=t/(c+F)<.5?-t:c+F-t;O(n,[n.scrollLeft,n.scrollTop],[n.scrollLeft+e,n.scrollLeft],300)}}),50)},$=1e3,function(){clearTimeout(B),B=setTimeout((function(){j()}),$)});var j,$,B;function P(){const e=m[r[2]-1];e instanceof HTMLElement&&O(n,[n.scrollLeft,n.scrollTop],[e.offsetLeft,n.scrollTop],300,L)}function q(){m&&m.length>0&&(p=new IntersectionObserver((e=>{if(!0===e[0].isIntersecting){const t=Array.from(m).indexOf(e[0].target);t>-1&&t>r[2]-1&&N.set([H[0],H[1],t+1])}}),{threshold:[0]}),Array.from(m).forEach((e=>p.observe(e))))}I((()=>{var e,t;m=document.querySelectorAll(".reader p"),H&&(t=H,(!(e=r)||!e[0]||!e[1])&&t||t[0]>e[0]||t[0]===e[0]&&t[1]>e[1])?(N.set([H[0],H[1],1]),q()):r[0]===H[0]&&r[1]===H[1]&&r[2]>1?(o(10,w=!0),q()):r[0]===H[0]&&r[1]===H[1]&&1===r[2]&&q(),C(),setTimeout((()=>{C(),u=(window.pageYOffset||document.documentElement.scrollTop)+l.top,O(window,[window.scrollX,window.scrollY],[window.scrollX,u],600)}),2e3)}));let H;return e.$$set=e=>{"content"in e&&o(0,v=e.content),"snippet"in e&&o(1,x=e.snippet),"book"in e&&o(2,b=e.book),"chapter"in e&&o(3,g=e.chapter),"nextChapterExists"in e&&o(4,y=e.nextChapterExists)},e.$$.update=()=>{1073741824&e.$$.dirty[0]&&(H=s.params.slug?s.params.slug.map((e=>+e)):null),28&e.$$.dirty[0]&&o(11,d=!y&&b<3?[b+1,1]:[b,g+1])},[v,x,b,g,y,n,c,h,f,k,w,d,a,A,C,({clientX:e,target:t})=>{if("IMG"===t.tagName)o(9,k=!0),setTimeout((()=>{o(8,f.innerHTML=t.outerHTML,f)}),1);else if(e&&l&&l.left&&c){const t=l.left+c/2,o=c+F;O(n,[n.scrollLeft,n.scrollTop],[n.scrollLeft+(e<=t?-1:1)*o,n.scrollTop],300,L)}},P,()=>C(),function(e){D[e?"unshift":"push"]((()=>{n=e,o(5,n)}))},function(e){D[e?"unshift":"push"]((()=>{f=e,o(8,f)}))},()=>o(9,k=!1),()=>{V.set(!1)},()=>{o(10,w=!1),P()},()=>{o(10,w=!1),N.set([N[0],N[1],1])}]}export default class extends e{constructor(e){super(),t(this,e,U,_,o,{content:0,snippet:1,book:2,chapter:3,nextChapterExists:4},[-1,-1])}}export{X as preload};
