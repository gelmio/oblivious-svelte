import{S as t,i as e,s as o,e as s,c as a,b as n,f as r,h as l,j as i,l as c,y as h,t as u,a as f,g as p,d,k as m,C as v,D as x,v as g,m as b,z as y,A as k,E as w,r as E,G as T,O as C,Q as A,n as I,I as $,q as j,R as L,K as B,T as D}from"./client.a8e419c7.js";import{g as P}from"./reader-hints.d7b123ce.js";function V(t,e,o,s,a=null){let n;const r=l=>{const i=l-n,c=i/s,h=[e[0]+(o[0]-e[0])*c,e[1]+(o[1]-e[1])*c];i<s?(t.scrollTo(h[0],h[1]),requestAnimationFrame(r)):(t.scrollTo(o[0],o[1]),a&&a())};requestAnimationFrame((t=>{n=t,r(t)}))}const{document:q,window:N}=A;function z(t){let e,o,c,v,x,g,b,y,k,w,E;return{c(){e=s("div"),o=s("p"),c=u("Congrats! You've made it to the end of Book 2!"),v=f(),x=s("p"),g=u("That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),b=f(),y=s("p"),k=u("While you wait, feel free to jump on the mailing list, or "),w=s("a"),E=u("flick me some money to keep the wheels rolling!"),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=n(e);o=a(s,"P",{});var l=n(o);c=p(l,"Congrats! You've made it to the end of Book 2!"),l.forEach(r),v=d(s),x=a(s,"P",{});var i=n(x);g=p(i,"That's as far as things go for the moment, but Book 3 is on\n\t\t\t\t\tthe way out soon!"),i.forEach(r),b=d(s),y=a(s,"P",{});var h=n(y);k=p(h,"While you wait, feel free to jump on the mailing list, or "),w=a(h,"A",{href:!0,rel:!0,class:!0});var u=n(w);E=p(u,"flick me some money to keep the wheels rolling!"),u.forEach(r),h.forEach(r),s.forEach(r),this.h()},h(){l(w,"href","https://transactions.sendowl.com/products/78458726/77A44CD1/add_to_cart"),l(w,"rel","nofollow"),l(w,"class","border-b border-oblivious-dark"),l(e,"class","text-center font-header mt-8")},m(t,s){i(t,e,s),m(e,o),m(o,c),m(e,v),m(e,x),m(x,g),m(e,b),m(e,y),m(y,k),m(y,w),m(w,E)},p:h,d(t){t&&r(e)}}}function G(t){let e,o,c,h,v,x,g=t[4]?"Chapter":"Book",y=t[10][1]>10&&!(t[10][1]%5)&&H();return{c(){e=s("div"),o=s("a"),c=u("Next "),h=u(g),x=f(),y&&y.c(),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=n(e);o=a(s,"A",{rel:!0,href:!0,class:!0});var l=n(o);c=p(l,"Next "),h=p(l,g),l.forEach(r),x=d(s),y&&y.l(s),s.forEach(r),this.h()},h(){l(o,"rel","prefetch"),l(o,"href",v="read/"+t[10][0]+"/"+t[10][1]),l(o,"class","inline-block text-lg p-2 rounded-lg no-underline bg-oblivious mr-4"),l(e,"class","flex flex-col md:flex-row justify-end items-end mt-8")},m(t,s){i(t,e,s),m(e,o),m(o,c),m(o,h),m(e,x),y&&y.m(e,null)},p(t,s){16&s&&g!==(g=t[4]?"Chapter":"Book")&&b(h,g),1024&s&&v!==(v="read/"+t[10][0]+"/"+t[10][1])&&l(o,"href",v),t[10][1]>10&&!(t[10][1]%5)?y||(y=H(),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},d(t){t&&r(e),y&&y.d()}}}function H(t){let e,o,c,h;return{c(){e=s("span"),o=u("... or "),c=s("a"),h=u("flick me some money!"),this.h()},l(t){e=a(t,"SPAN",{class:!0});var s=n(e);o=p(s,"... or "),c=a(s,"A",{href:!0,rel:!0,class:!0});var l=n(c);h=p(l,"flick me some money!"),l.forEach(r),s.forEach(r),this.h()},h(){l(c,"href","https://transactions.sendowl.com/products/78458726/77A44CD1/add_to_cart"),l(c,"rel","nofollow"),l(c,"class","border-b border-oblivious-dark"),l(e,"class","m-2")},m(t,s){i(t,e,s),m(e,o),m(e,c),m(c,h)},d(t){t&&r(e)}}}function M(t){let e,o,u,f;return{c(){e=s("div"),this.h()},l(t){e=a(t,"DIV",{class:!0}),n(e).forEach(r),this.h()},h(){l(e,"class","fixed inset-0 flex justify-center items-center cursor-zoom-out bg-oblivious-opaque")},m(o,s){i(o,e,s),t[16](e),u||(f=c(e,"click",t[17]),u=!0)},p:h,i(t){o||I((()=>{o=$(e,j,{}),o.start()}))},o:h,d(o){o&&r(e),t[16](null),u=!1,f()}}}function O(t){let e,o,x,g,b,y,k,w,E,T,C,A,L,B,D,P,V,q,N,z,G,H,M,O,W;return{c(){e=s("div"),o=s("div"),x=s("p"),g=u("Here's some tips:"),b=f(),y=s("p"),k=u("Tap the text to turn the pages."),w=f(),E=s("p"),T=u("Tap the images to zoom."),C=f(),A=s("p"),L=u("I'll help you out by keeping track of where you're up to."),B=f(),D=s("p"),P=u("I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),V=f(),q=s("div"),N=s("span"),z=u("Got it"),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=n(e);o=a(s,"DIV",{class:!0});var l=n(o);x=a(l,"P",{class:!0});var i=n(x);g=p(i,"Here's some tips:"),i.forEach(r),b=d(l),y=a(l,"P",{class:!0});var c=n(y);k=p(c,"Tap the text to turn the pages."),c.forEach(r),w=d(l),E=a(l,"P",{class:!0});var h=n(E);T=p(h,"Tap the images to zoom."),h.forEach(r),C=d(l),A=a(l,"P",{class:!0});var u=n(A);L=p(u,"I'll help you out by keeping track of where you're up to."),u.forEach(r),B=d(l),D=a(l,"P",{class:!0});var f=n(D);P=p(f,"I'll also scroll automatically to where the pages are so you\n\t\t\t\tdon't have to bother your finger..."),f.forEach(r),V=d(l),q=a(l,"DIV",{});var m=n(q);N=a(m,"SPAN",{class:!0});var v=n(N);z=p(v,"Got it"),v.forEach(r),m.forEach(r),l.forEach(r),s.forEach(r),this.h()},h(){l(x,"class","font-header text-xl md:text-2xl mb-4"),l(y,"class","font-sans text-base md:text-lg mb-1"),l(E,"class","font-sans text-base md:text-lg mb-1"),l(A,"class","font-sans text-base md:text-lg mb-1"),l(D,"class","font-sans text-base md:text-lg mb-1"),l(N,"class","inline-block text-base md:text-lg p-2 rounded-lg no-underline bg-oblivious cursor-pointer"),l(o,"class","rounded-lg bg-white p-2 md:p-16 flex flex-col text-center m-2"),l(e,"class","fixed inset-0 flex justify-center items-center bg-oblivious-opaque z-10")},m(s,a){i(s,e,a),m(e,o),m(o,x),m(x,g),m(o,b),m(o,y),m(y,k),m(o,w),m(o,E),m(E,T),m(o,C),m(o,A),m(A,L),m(o,B),m(o,D),m(D,P),m(o,V),m(o,q),m(q,N),m(N,z),M=!0,O||(W=c(N,"click",t[18]),O=!0)},p:h,i(t){M||(I((()=>{H&&H.end(1),G||(G=$(e,j,{delay:1e3})),G.start()})),M=!0)},o(t){G&&G.invalidate(),H=v(e,j,{}),M=!1},d(t){t&&r(e),t&&H&&H.end(),O=!1,W()}}}function W(t){let e,o,h,v,T,C,A,I,$,j,D,P,V,H,W,Y,_,S,X,F,K,Q,J;function U(t,e){return t[10][0]<3?G:z}q.title=e="Oblivious | Book "+t[2]+", Chapter "+t[3]+" | An overlanding motorbike journey\n\t\tthrough West Africa";let Z=U(t),tt=Z(t),et=t[9]&&M(t),ot=t[11]&&O(t);return{c(){o=s("meta"),h=f(),v=s("article"),T=s("h2"),C=u("Book "),A=u(t[2]),I=u(", Chapter "),$=u(t[3]),j=f(),D=s("div"),V=f(),tt.c(),W=f(),Y=s("div"),_=u("Oblivious | Luke Gelmi"),S=f(),et&&et.c(),X=f(),ot&&ot.c(),F=x(),this.h()},l(e){const s=g('[data-svelte="svelte-gmim4n"]',q.head);o=a(s,"META",{name:!0,content:!0}),s.forEach(r),h=d(e),v=a(e,"ARTICLE",{class:!0});var l=n(v);T=a(l,"H2",{class:!0});var i=n(T);C=p(i,"Book "),A=p(i,t[2]),I=p(i,", Chapter "),$=p(i,t[3]),i.forEach(r),j=d(l),D=a(l,"DIV",{class:!0,style:!0});var c=n(D);V=d(c),tt.l(c),c.forEach(r),W=d(l),Y=a(l,"DIV",{class:!0});var u=n(Y);_=p(u,"Oblivious | Luke Gelmi"),u.forEach(r),l.forEach(r),S=d(e),et&&et.l(e),X=d(e),ot&&ot.l(e),F=x(),this.h()},h(){l(o,"name","description"),l(o,"content",t[1]),l(T,"class","font-header"),P=new L(V),l(D,"class","overflow-hidden no-scrollbar py-12 svelte-1hqhvkr"),l(D,"style",H=t[6]&&t[7]?`height: ${t[7]}px; columns: auto ${t[6]}px; column-gap: ${R}px; column-rule: 1px solid #000;`:""),l(Y,"class","text-xs text-center -mt-10"),l(v,"class","prose md:prose-xl text-justify mb-8 md:mb-12 pt-16")},m(e,s){m(q.head,o),i(e,h,s),i(e,v,s),m(v,T),m(T,C),m(T,A),m(T,I),m(T,$),m(v,j),m(v,D),P.m(t[0],D),m(D,V),tt.m(D,null),t[15](D),m(v,W),m(v,Y),m(Y,_),i(e,S,s),et&&et.m(e,s),i(e,X,s),ot&&ot.m(e,s),i(e,F,s),K=!0,Q||(J=[c(N,"resize",t[14]),c(D,"click",t[13])],Q=!0)},p(t,[s]){(!K||12&s)&&e!==(e="Oblivious | Book "+t[2]+", Chapter "+t[3]+" | An overlanding motorbike journey\n\t\tthrough West Africa")&&(q.title=e),(!K||2&s)&&l(o,"content",t[1]),(!K||4&s)&&b(A,t[2]),(!K||8&s)&&b($,t[3]),(!K||1&s)&&P.p(t[0]),Z===(Z=U(t))&&tt?tt.p(t,s):(tt.d(1),tt=Z(t),tt&&(tt.c(),tt.m(D,null))),(!K||192&s&&H!==(H=t[6]&&t[7]?`height: ${t[7]}px; columns: auto ${t[6]}px; column-gap: ${R}px; column-rule: 1px solid #000;`:""))&&l(D,"style",H),t[9]?et?(et.p(t,s),512&s&&y(et,1)):(et=M(t),et.c(),y(et,1),et.m(X.parentNode,X)):et&&(et.d(1),et=null),t[11]?ot?(ot.p(t,s),2048&s&&y(ot,1)):(ot=O(t),ot.c(),y(ot,1),ot.m(F.parentNode,F)):ot&&(B(),k(ot,1,1,(()=>{ot=null})),w())},i(t){K||(y(et),y(ot),K=!0)},o(t){k(ot),K=!1},d(e){r(o),e&&r(h),e&&r(v),tt.d(),t[15](null),e&&r(S),et&&et.d(e),e&&r(X),ot&&ot.d(e),e&&r(F),Q=!1,E(J)}}}var Y=function(t,e,o,s){return new(o||(o=Promise))((function(a,n){function r(t){try{i(s.next(t))}catch(t){n(t)}}function l(t){try{i(s.throw(t))}catch(t){n(t)}}function i(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,l)}i((s=s.apply(t,e||[])).next())}))};function _({params:t,query:e}){return Y(this,void 0,void 0,(function*(){const[e,o]=t.slug.map((t=>+t)),s=yield this.fetch(`read/${e}/${o}.json`),{chapter:a,snippet:n,nextChapterExists:r,message:l}=yield s.json();if(200===s.status)return{content:a,snippet:n,book:e,chapter:o,nextChapterExists:r};this.error(s.status,l)}))}let R=50;function S(t,e,o){let s;T(t,P,(t=>o(11,s=t)));let a,n,r,l,i,c,h,u,{content:f}=e,{snippet:p}=e,{book:d}=e,{chapter:m}=e,{nextChapterExists:v}=e,x=!1;function g(){r=[window.innerWidth,window.innerHeight],(!n||!i||!l||r[0]<l||r[1]<i||r[0]>l+100||r[1]>i+100)&&(o(7,i=Math.round(r[1])),n=a.getBoundingClientRect(),o(6,l=Math.round(n.width)))}const b=(y=()=>{const t=a.scrollLeft;setTimeout((()=>{const e=a.scrollLeft%(l+R);if(t===a.scrollLeft&&e){const t=e/(l+R)<.5?-e:l+R-e;V(a,[a.scrollLeft,a.scrollTop],[a.scrollLeft+t,a.scrollLeft],300)}}),50)},k=1e3,function(){clearTimeout(w),w=setTimeout((function(){y()}),k)});var y,k,w;C((()=>{setTimeout((()=>{g()}),600),setTimeout((()=>{c=(window.pageYOffset||document.documentElement.scrollTop)+n.top,V(window,[window.scrollX,window.scrollY],[window.scrollX,c],600)}),2e3)}));return t.$$set=t=>{"content"in t&&o(0,f=t.content),"snippet"in t&&o(1,p=t.snippet),"book"in t&&o(2,d=t.book),"chapter"in t&&o(3,m=t.chapter),"nextChapterExists"in t&&o(4,v=t.nextChapterExists)},t.$$.update=()=>{28&t.$$.dirty&&o(10,u=!v&&d<3?[d+1,1]:[d,m+1])},[f,p,d,m,v,a,l,i,h,x,u,s,g,({clientX:t,target:e})=>{if("IMG"===e.tagName)o(9,x=!0),setTimeout((()=>{o(8,h.innerHTML=e.outerHTML,h)}),1);else if(t&&n&&n.left&&l){const e=n.left+l/2,o=l+R;V(a,[a.scrollLeft,a.scrollTop],[a.scrollLeft+(t<=e?-1:1)*o,a.scrollTop],300,b)}},()=>g(),function(t){D[t?"unshift":"push"]((()=>{a=t,o(5,a)}))},function(t){D[t?"unshift":"push"]((()=>{h=t,o(8,h)}))},()=>o(9,x=!1),()=>{P.set(!1)}]}export default class extends t{constructor(t){super(),e(this,t,S,W,o,{content:0,snippet:1,book:2,chapter:3,nextChapterExists:4})}}export{_ as preload};
